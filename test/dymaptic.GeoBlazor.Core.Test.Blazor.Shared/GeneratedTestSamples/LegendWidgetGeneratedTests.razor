@inherits TestRunnerBase

@{
    base.BuildRenderTree(__builder);
}

@code {

    [TestMethod]
    public async Task TestCanRenderGeneratedLegendWidget(Action renderHandler)
    {
        LegendWidget? legendWidget = null;

        AddMapRenderFragment(
            @<MapView class="map-view" OnViewRendered="renderHandler">
                <Map>
                    <Basemap>
                        <BasemapStyle Name="BasemapStyleName.ArcgisTopographic" />
                    </Basemap>
                </Map>
                <LegendWidget 
                    BasemapLegendVisible="@(true)"
                    HeadingLevel="@(482.9212)"
                    HideLayersNotInCurrentView="@(true)"
                    Icon="@("et")"
                    Label="@("iure")"
                    RespectLayerDefinitionExpression="@(true)"
                    RespectLayerVisibility="@(true)"
                    WidgetId="@("voluptas")">
                    <LegendViewModel 
                        BasemapLegendVisible="@(true)"
                        HideLayersNotInCurrentView="@(true)"
                        LayerInfos="@([new LegendViewModelLayerInfos(new FeatureLayer("https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/IncidentsReport/FeatureServer/0",
                                new PortalItem(),
                                [new Graphic(new Point(76.4062,
                                            58.5836,
                                            -87.2318,
                                            -40.0583,
                                            575.9111,
                                        new SpatialReference(1,
                                                "quia",
                                                "iste",
                                                "neque"),
                                            true,
                                            true,
                                            786.6199),
                                    new TextSymbol("culpa tempore quia",
                                        new MapColor(236, 40, 178),
                                        new MapColor(6, 27, 161),
                                            new Dimension(237.0419),
                                        new MapFont(new Dimension(226.6722),
                                                "Times New Roman",
                                            MapFontStyle.Oblique,
                                            FontWeight.Bolder,
                                            TextDecoration.Underline),
                                            278.2987,
                                        new MapColor(242, 229, 200),
                                        new MapColor(145, 98, 208),
                                            263.8982,
                                        HorizontalAlignment.Center,
                                            true,
                                            491.6820,
                                            new Dimension(550.8407),
                                            true),
                                    new PopupTemplate("eum maxime pariatur",
                                            "vel",
                                            ["accusamus"],
                                        [new FieldInfo("email",
                                                "voluptas",
                                                "ex",
                                            StringFieldOption.RichText,
                                            new FieldInfoFormat(9,
                                                    true,
                                                DateFormat.LongDateShortTime),
                                                true,
                                                true,
                                            StatisticType.Sum),
                                        new FieldInfo("avatar",
                                                "consectetur",
                                                "est",
                                            StringFieldOption.TextArea,
                                            new FieldInfoFormat(3,
                                                    true,
                                                DateFormat.DayShortMonthYearShortTime),
                                                true,
                                                true,
                                            StatisticType.Min)],
                                        [new FieldsPopupContent([new FieldInfo("phone",
                                                    "consequatur",
                                                    "inventore",
                                                StringFieldOption.TextBox,
                                                new FieldInfoFormat(9,
                                                        true,
                                                    DateFormat.LongMonthDayYear),
                                                    true,
                                                    true,
                                                StatisticType.Stddev)],
                                                "laudantium ea",
                                                "asperiores sapiente eum")],
                                        [new ExpressionInfo("var length = Geometry($feature).length; return length;",
                                                "category",
                                                "fuga ducimus et",
                                                ExpressionInfoReturnType.String)],
                                            true,
                                            true,
                                            [new ActionButton("voluptates rem ipsam",
                                                "https://picsum.photos/640/480/?image=991",
                                                "627eb1b7-4bdf-8f40-8e81-b0f30250954c",
                                                () => { Console.WriteLine("delectus"); return Task.CompletedTask; },
                                                "phone",
                                                true,
                                                true,
                                                true,
                                                "eaque"),
                                                new ActionButton("numquam animi libero",
                                                    "https://picsum.photos/640/480/?image=761",
                                                    "4e23d7e0-99e9-6b3c-ac26-707ab14ca599",
                                                    () => { Console.WriteLine("cum"); return Task.CompletedTask; },
                                                    "token",
                                                    true,
                                                    true,
                                                    true,
                                                    "sint")]),
                                        new AttributesDictionary(),
                                        true,
                                        "laborum",
                                        "similique",
                                        new GraphicOrigin(Guid.NewGuid(),
                                            "quaerat",
                                            7))],
                                    ["cumque",
                                        "pariatur"],
                                    "quae",
                                    48552.1658,
                                    23378489.7645,
                                    "pariatur",
                                    FeatureGeometryType.Polyline,
                                    "distinctio qui qui",
                                    0.0108,
                                    true,
                                ListMode.Hide,
                                new PopupTemplate("dolorem fuga autem",
                                        "deleniti",
                                        ["tempora",
                                            "velit"],
                                    [new FieldInfo("password",
                                            "architecto",
                                            "labore",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(5,
                                                true,
                                            DateFormat.ShortDateShortTime24),
                                            true,
                                            true,
                                        StatisticType.Count),
                                    new FieldInfo("title",
                                            "occaecati",
                                            "ut",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(8,
                                                true,
                                            DateFormat.DayShortMonthYearLongTime),
                                            true,
                                            true,
                                        StatisticType.Sum)],
                                    [new AttachmentsPopupContent("animi ipsum officiis",
                                            "tenetur unde nihil culpa",
                                            AttachmentsPopupContentDisplayType.Preview)],
                                    [new ExpressionInfo("return $feature.Name;",
                                            "title",
                                            "quas repellat exercitationem",
                                            ExpressionInfoReturnType.String),
                                    new ExpressionInfo("return $feature.Population / $feature.Area;",
                                            "category",
                                            "omnis voluptatibus id",
                                            ExpressionInfoReturnType.String)],
                                        true,
                                        true,
                                        [new ActionButton("explicabo laudantium quas",
                                            "https://picsum.photos/640/480/?image=843",
                                            "1336ada6-297a-a35a-b320-9f91a7894bd6",
                                            () => { Console.WriteLine("commodi"); return Task.CompletedTask; },
                                            "category",
                                            true,
                                            true,
                                            true,
                                            "omnis")])),
                                "assumenda deleniti culpa"),
                        new LegendViewModelLayerInfos(new WebTileLayer(BlendMode.Lighten,
                                    "sit",
                                    new Effect("ipsum",
                                        39026847.3448),
                                new Extent(78.6816,
                                        -114.5007,
                                        -37.0666,
                                        -26.2095,
                                        695.8820,
                                        61.4145,
                                        528.1430,
                                        45.8576,
                                    new SpatialReference(7,
                                            "delectus",
                                            "ut",
                                            "nam"),
                                        true,
                                        true),
                                ListMode.Hide,
                                    21484105.0162,
                                    11242.2126,
                                    0.9697,
                                    true,
                                new PortalItem(),
                                    526.7125,
                                    ["at"],
                                new TileInfo(704.8169,
                                        TileInfoFormat.Tiff,
                                        true,
                                    [new LOD(2,
                                            "necessitatibus",
                                            18.6923,
                                            38576451.7968)],
                                    new Point(1.0455,
                                            -89.3016,
                                            100.4432,
                                            -1.5702,
                                            116.8366,
                                        new SpatialReference(4,
                                                "illum",
                                                "magnam",
                                                "ea"),
                                            true,
                                            true,
                                            602.7397),
                                        [9,
                                            2],
                                    new SpatialReference(7,
                                            "perspiciatis",
                                            "corrupti",
                                            "et")),
                                    "voluptatem recusandae commodi"),
                                "ut repudiandae iusto")])"
                        RespectLayerVisibility="@(true)">
                        <ActiveLayerInfo 
                            HideLayersNotInCurrentView="@(true)"
                            IsScaleDriven="@(true)"
                            Layer="@(new BingMapsLayer("et",
                                    BingImageryStyle.Aerial,
                                BlendMode.Plus,
                                    new Effect("distinctio",
                                        10148397.4071),
                                    49919957.6774,
                                    36180.1010,
                                    329.1518,
                                new SpatialReference(8,
                                        "blanditiis",
                                        "sed",
                                        "saepe"),
                                    default,
                                new Extent(82.2071,
                                        -35.5629,
                                        32.4727,
                                        -37.9959,
                                        255.3473,
                                        260.7651,
                                        734.8563,
                                        303.4611,
                                    new SpatialReference(7,
                                            "non",
                                            "id",
                                            "id"),
                                        true,
                                        true),
                                ListMode.Show,
                                    0.4272,
                                    true,
                                    "est"))"
                            LayerView="@(new LayerView())"
                            LegendElements="@([default])"
                            Ready="@(true)"
                            RespectLayerVisibility="@(true)"
                            Scale="@(44648192.3560)"
                            SublayerIds="@([6,
                                1])"
                            Title="@("et enim a")"
                            Version="@(205.7420)">
                        </ActiveLayerInfo>
                    </LegendViewModel>
                    <LegendLayerInfos 
                        Layer="@(new WebTileLayer(BlendMode.Xor,
                                "dicta",
                                new Effect("consequatur",
                                    7694411.8328),
                            new Extent(-54.7338,
                                    173.4188,
                                    0.9759,
                                    -87.6623,
                                    490.9891,
                                    452.5474,
                                    209.5687,
                                    710.4941,
                                new SpatialReference(1,
                                        "itaque",
                                        "ut",
                                        "optio"),
                                    true,
                                    true),
                            ListMode.Show,
                                33409740.2203,
                                35561.0959,
                                0.6920,
                                true,
                            new PortalItem(),
                                811.8167,
                                ["totam"],
                            new TileInfo(698.1945,
                                    TileInfoFormat.Gif,
                                    true,
                                [new LOD(1,
                                        "dolores",
                                        82.0384,
                                        3910048.3664),
                                new LOD(1,
                                        "illum",
                                        23.1415,
                                        22465887.0081)],
                                new Point(134.5731,
                                        3.2680,
                                        -58.3337,
                                        -57.8907,
                                        849.6198,
                                    new SpatialReference(7,
                                            "facilis",
                                            "modi",
                                            "doloribus"),
                                        true,
                                        true,
                                        544.1604),
                                    [4],
                                new SpatialReference(4,
                                        "quaerat",
                                        "suscipit",
                                        "quis")),
                                "incidunt dignissimos et"))"
                        SublayerIds="@([1,
                            4])"
                        Title="@("omnis deleniti sed")">
                    </LegendLayerInfos>
                    <ActiveLayerInfo 
                        HideLayersNotInCurrentView="@(true)"
                        IsScaleDriven="@(true)"
                        LayerView="@(new LayerView())"
                        LegendElements="@([default])"
                        Ready="@(true)"
                        RespectLayerVisibility="@(true)"
                        Scale="@(30732566.6027)"
                        SublayerIds="@([4,
                            2])"
                        Title="@("cum quis beatae")"
                        Version="@(806.9899)">
                    </ActiveLayerInfo>
                </LegendWidget>
            </MapView>);
        await WaitForMapToRender();
        Assert.IsNotNull(legendWidget!);
        await AssertJavaScript("assertWidgetExists", args: "legend");
        IReadOnlyList<ActiveLayerInfo> testActiveLayerInfos = [new ActiveLayerInfo(true,
                    true,
                new WebTileLayer(BlendMode.Exclusion,
                        "veniam",
                        new Effect("eum",
                            31546472.9136),
                    new Extent(26.3364,
                            -122.6678,
                            -36.2951,
                            35.4998,
                            485.0944,
                            777.5852,
                            879.1736,
                            710.4964,
                        new SpatialReference(9,
                                "fugiat",
                                "aliquid",
                                "assumenda"),
                            true,
                            true),
                    ListMode.Hide,
                        38553890.2319,
                        36260.1106,
                        0.0429,
                        true,
                    new PortalItem(),
                        698.3047,
                        ["voluptatem"],
                    new TileInfo(888.6021,
                            TileInfoFormat.Png24,
                            true,
                        [new LOD(9,
                                "placeat",
                                57.5557,
                                27745143.3175)],
                        new Point(-98.2208,
                                -54.9893,
                                145.9106,
                                -78.6952,
                                537.2853,
                            new SpatialReference(1,
                                    "est",
                                    "voluptatem",
                                    "sunt"),
                                true,
                                true,
                                790.1624),
                            [3,
                                2],
                        new SpatialReference(8,
                                "dolorem",
                                "et",
                                "exercitationem")),
                        "repellat doloribus qui"),
                new FeatureLayerView(new LayerView(),
                        new AbortManager(default,
                            new JsModuleManager()),
                    new FeatureEffect([new Effect("id",
                            44916176.3613),
                            new Effect("molestias",
                                5355880.3358)],
                            true,
                        new FeatureFilter(696.0478,
                            new Point(-44.3663,
                                    -26.1526,
                                    -67.4690,
                                    14.0839,
                                    473.8946,
                                new SpatialReference(4,
                                        "natus",
                                        "iure",
                                        "soluta"),
                                    true,
                                    true,
                                    828.2109),
                                [2,
                                    4],
                            SpatialRelationship.IndexIntersects,
                            new TimeExtent(new DateTime(2002, 11, 2, 22, 48, 0),
                                    new DateTime(2002, 9, 19, 0, 22, 25)),
                                QueryUnits.NauticalMiles,
                                "Street = '123 Main St.'"),
                            [new Effect("consequuntur",
                                24668814.1848)]),
                    new FeatureFilter(862.8275,
                        new Polyline([new MapPath([new MapPoint([958.9291])])],
                            new SpatialReference(3,
                                    "ea",
                                    "neque",
                                    "illum"),
                                true,
                                true),
                            [2,
                                1],
                        SpatialRelationship.Relation,
                        new TimeExtent(new DateTime(2023, 9, 4, 1, 18, 4),
                                new DateTime(2006, 5, 13, 22, 41, 17)),
                            QueryUnits.Miles,
                            "Name = 'John Doe'"),
                    new HighlightOptions(new MapColor(236, 96, 77),
                        new MapColor(249, 194, 161),
                            281.2243,
                            690.2507,
                        new MapColor(91, 110, 49),
                            507.7692,
                            3.9175),
                        482.2888,
                        true),
                [default,
                default],
                    true,
                    true,
                    10838119.5647,
                    [7],
                    "quaerat dolores enim",
                    586.9310),
            new ActiveLayerInfo(true,
                    true,
                new WCSLayer("https://sampleserver6.arcgisonline.com/arcgis/services/ScientificData/SeaTemperature/ImageServer/WCSServer",
                    [new DimensionalDefinition("avatar",
                            true,
                            "name")],
                        new RasterStretchRenderer(new AlgorithmicColorRamp(Algorithm.CieLab,
                                new MapColor(247, 187, 66),
                                new MapColor(177, 223, 10)),
                            true,
                            true,
                            [8],
                            4,
                            6,
                            StretchType.MinMax,
                            [new RasterBandStatistics(546.0249,
                                1,
                                320.6547,
                                271.4058,
                                693.0741,
                                703.0833,
                                888.0888,
                                578.3973)],
                            true,
                            8),
                        0.7686,
                        "magni rerum quaerat",
                    new PortalItem(),
                        [5,
                            3],
                    BlendMode.Lighten,
                        "nihil",
                        "sunt",
                    new CoverageInfo(["updatedAt"],
                        new CoverageDescriptionV201(new CoverageDescriptionV201BoundedBy(["laborum",
                                    "dolore"],
                                    new DateTime(2011, 2, 27, 1, 32, 35),
                                    new DateTime(2009, 7, 6, 19, 7, 13),
                                new Extent(-145.3467,
                                        -87.6000,
                                        79.2296,
                                        60.6905,
                                        52.8741,
                                        459.0343,
                                        426.0282,
                                        193.0731,
                                    new SpatialReference(6,
                                            "et",
                                            "dignissimos",
                                            "laboriosam"),
                                        true,
                                        true),
                                new CoverageDescriptionV201BoundedByEnvelopeAllDims([159.0912],
                                        [410.9608,
                                            186.3639]),
                                    true,
                                    ["itaque"]),
                                "maxime",
                                "deleniti",
                            new CoverageDescriptionV201DomainSet(["reprehenderit",
                                    "itaque"],
                                    48.1729,
                                    [317.7795,
                                        232.1252],
                                    true,
                                    [981.0352],
                                    [963.0328,
                                        967.0344],
                                new CoverageDescriptionV201DomainSetResolution(36.6005,
                                        -13.8940),
                                    977.5746),
                            new CoverageDescriptionV201EoMetadata(new CoverageDescriptionV201EoMetadataObservation("quibusdam",
                                    new Polygon([new MapPath([new MapPoint([195.7841,
                                                769.2568]),
                                            new MapPoint([371.1410])])],
                                        new SpatialReference(3,
                                                "eos",
                                                "ut",
                                                "omnis"),
                                        new Point(-19.3752,
                                                -23.0275,
                                                19.6359,
                                                -27.1687,
                                                949.6301,
                                            new SpatialReference(4,
                                                    "voluptas",
                                                    "modi",
                                                    "sunt"),
                                                true,
                                                true,
                                                934.6437),
                                            true,
                                            true,
                                            true),
                                        "exercitationem",
                                    new TemporalDomain(new DateTime(2000, 6, 9, 3, 26, 56),
                                            new DateTime(2001, 1, 4, 20, 6, 38),
                                            9.6250,
                                            "eligendi",
                                            [new DateTime(2015, 7, 14, 22, 31, 53)]),
                                    new TemporalDomain(new DateTime(2022, 6, 2, 17, 52, 25),
                                            new DateTime(2023, 10, 1, 11, 13, 11),
                                            72.3484,
                                            "animi",
                                            [new DateTime(2012, 9, 16, 12, 6, 56),
                                                new DateTime(2001, 8, 16, 11, 23, 27)]),
                                        "doloribus")),
                                "molestiae",
                            [new CoverageDescriptionV201RangeType([346.2655],
                                    "fuga voluptate",
                                    "title",
                                    228.6168,
                                    "aut"),
                            new CoverageDescriptionV201RangeType([825.7901],
                                    "voluptate incidunt",
                                    "updatedAt",
                                    803.4291,
                                    "nihil")],
                            new CoverageDescriptionV201Resolution(90.8983,
                                    80.6351),
                                "reprehenderit",
                                "5.1.0.3"),
                            "architecto",
                            "et in dolor",
                        new Extent(137.5704,
                                68.6046,
                                -51.8669,
                                -77.7311,
                                577.7871,
                                286.2689,
                                91.1906,
                                447.7859,
                            new SpatialReference(3,
                                    "a",
                                    "qui",
                                    "molestiae"),
                                true,
                                true),
                        new RasterInfo(new FeatureSet("password",
                                    true,
                                [new Graphic(new Polygon([new MapPath([new MapPoint([140.7894,
                                                382.1760]),
                                            new MapPoint([971.6185,
                                                888.2245])]),
                                            new MapPath([new MapPoint([723.4347,
                                                    254.3314])])],
                                        new SpatialReference(8,
                                                "cupiditate",
                                                "cupiditate",
                                                "qui"),
                                        new Point(-10.9636,
                                                -2.3169,
                                                -104.1202,
                                                86.8878,
                                                11.6408,
                                            new SpatialReference(1,
                                                    "expedita",
                                                    "et",
                                                    "iste"),
                                                true,
                                                true,
                                                135.5286),
                                            true,
                                            true,
                                            true),
                                    new TextSymbol("quidem aperiam corrupti",
                                        new MapColor(178, 190, 157),
                                        new MapColor(95, 157, 155),
                                            new Dimension(276.3473),
                                        new MapFont(new Dimension(824.9399),
                                                "Bookman",
                                            MapFontStyle.Normal,
                                            FontWeight.Lighter,
                                            TextDecoration.None),
                                            590.7910,
                                        new MapColor(233, 251, 158),
                                        new MapColor(127, 23, 251),
                                            535.8646,
                                        HorizontalAlignment.Left,
                                            true,
                                            189.4059,
                                            new Dimension(346.6254),
                                            true),
                                    new PopupTemplate("aliquid reprehenderit saepe",
                                            "non",
                                            ["modi",
                                                "voluptate"],
                                        [new FieldInfo("avatar",
                                                "aut",
                                                "iste",
                                            StringFieldOption.TextArea,
                                            new FieldInfoFormat(4,
                                                    true,
                                                DateFormat.LongDate),
                                                true,
                                                true,
                                            StatisticType.Sum)],
                                        [new AttachmentsPopupContent("totam laboriosam deleniti",
                                                "iusto ab",
                                                AttachmentsPopupContentDisplayType.Preview),
                                        new AttachmentsPopupContent("quod quia ex",
                                                "consectetur ipsum quia explicabo",
                                                AttachmentsPopupContentDisplayType.Preview)],
                                        [new ExpressionInfo("return $feature.City + ', ' + $feature.Country;",
                                                "category",
                                                "nihil velit suscipit",
                                                ExpressionInfoReturnType.String)],
                                            true,
                                            true,
                                            [new ActionButton("qui possimus consequatur",
                                                "https://picsum.photos/640/480/?image=752",
                                                "4ebafd65-806d-d1a3-8f13-0153e8d77842",
                                                () => { Console.WriteLine("doloribus"); return Task.CompletedTask; },
                                                "name",
                                                true,
                                                true,
                                                true,
                                                "consequatur"),
                                                new ActionButton("voluptates modi aspernatur",
                                                    "https://picsum.photos/640/480/?image=881",
                                                    "1daf3271-09b3-8533-7951-a04ccbb48a55",
                                                    () => { Console.WriteLine("in"); return Task.CompletedTask; },
                                                    "status",
                                                    true,
                                                    true,
                                                    true,
                                                    "ut")]),
                                        new AttributesDictionary(),
                                        true,
                                        "porro",
                                        "aspernatur",
                                        new GraphicOrigin(Guid.NewGuid(),
                                            "ad",
                                            7))],
                                [new Field(default,
                                        "email",
                                        "et",
                                        "dicta et",
                                        9,
                                        true,
                                        true,
                                        new { Value = "pariatur" },
                                    FieldValueType.Description,
                                    new InheritedDomain("group"))],
                                GeometryType.Mesh,
                                new Polygon([new MapPath([new MapPoint([643.8080])]),
                                        new MapPath([new MapPoint([316.1796,
                                                42.4158]),
                                            new MapPoint([482.4360,
                                                686.5870])])],
                                    new SpatialReference(3,
                                            "quod",
                                            "molestias",
                                            "fugiat"),
                                    new Point(-9.8296,
                                            48.3007,
                                            148.9781,
                                            68.0687,
                                            297.3287,
                                        new SpatialReference(1,
                                                "quibusdam",
                                                "error",
                                                "eveniet"),
                                            true,
                                            true,
                                            242.2653),
                                        true,
                                        true,
                                        true),
                                new SpatialReference(6,
                                        "odit",
                                        "libero",
                                        "unde")),
                                9,
                            [new RasterBandInfo(50.5268,
                                    669.7381,
                                    "avatar",
                                    111.6449,
                                    806.1920,
                                    565.8762,
                                    127.6819,
                                    443.4760),
                            new RasterBandInfo(556.7899,
                                    406.6837,
                                    "id",
                                    147.9913,
                                    776.3438,
                                    5.7406,
                                    889.9100,
                                    768.0350)],
                                [new ColormapPixel(890.4539,
                                    762.0420,
                                    446.7684,
                                    23.8715)],
                            DataType.VectorUv,
                            new Extent(-78.3009,
                                    125.8492,
                                    62.1378,
                                    -45.4284,
                                    48.9096,
                                    59.9736,
                                    504.8442,
                                    406.1836,
                                new SpatialReference(3,
                                        "magni",
                                        "provident",
                                        "ut"),
                                    true,
                                    true),
                                true,
                                1,
                                ["doloremque"],
                                "rerum",
                            new RasterMultidimensionalInfo([new RasterMultidimensionalInfoVariables("sed sunt",
                                    [new RasterMultidimensionalInfoVariablesDimensions("reprehenderit ex eos a",
                                            [501.6932],
                                            true,
                                            285.2471,
                                            "omnis",
                                            "createdAt",
                                            "perspiciatis",
                                            [399.3668,
                                                522.3374])],
                                    [new RasterHistogram([35.6916],
                                            [5,
                                                7],
                                            285.4551,
                                            820.2488,
                                            5)],
                                        "createdAt",
                                    [new RasterBandStatistics(669.4426,
                                            1,
                                            726.8981,
                                            644.2634,
                                            24.7673,
                                            471.6375,
                                            321.6336,
                                            136.6258),
                                    new RasterBandStatistics(714.3256,
                                            9,
                                            769.4339,
                                            927.8584,
                                            875.7206,
                                            905.3574,
                                            474.9615,
                                            831.7111)],
                                        "veritatis")]),
                            new RasterInfoPixelSize(-165.8250,
                                    22.5102),
                            PixelType.C128,
                            new RasterSensorInfo(new DateTime(2022, 8, 20, 17, 34, 38),
                                    681.5690,
                                    "id",
                                    941.9840,
                                    956.2164,
                                    "id",
                                    880.3201,
                                    137.7735)),
                            ["nemo",
                                "eveniet"],
                        [SupportedInterpolations.Bilinear,
                        SupportedInterpolations.Nearest],
                            "sed sapiente ut",
                            true,
                        CoverageInfoVersion.One_0_0),
                        default,
                        new Effect("eaque",
                            2344806.9591),
                    new Extent(12.6950,
                            -33.4592,
                            -63.3698,
                            -0.7583,
                            398.6627,
                            97.7407,
                            648.2823,
                            634.1845,
                        new SpatialReference(4,
                                "fugit",
                                "rerum",
                                "magni"),
                            true,
                            true)),
                new LayerView(),
                [],
                    true,
                    true,
                    37627132.1952,
                    [3,
                        3],
                    "possimus sint dicta",
                    378.0494)];
        await legendWidget.SetActiveLayerInfos(testActiveLayerInfos);
        var activeLayerInfos = await legendWidget.GetActiveLayerInfos();
        Assert.AreEqual(testActiveLayerInfos, activeLayerInfos);
        LegendViewModel testViewModel = new LegendViewModel([new ActiveLayerInfo(true,
                        true,
                    new FeatureLayer("https://services9.arcgis.com/RHVPKKiFTONKtxq3/arcgis/rest/services/NDFD_Precipitation_v1/FeatureServer/0",
                        new PortalItem(),
                        [new Graphic(new Polygon([new MapPath([new MapPoint([952.0514,
                                        674.2856])])],
                                new SpatialReference(7,
                                        "cupiditate",
                                        "harum",
                                        "id"),
                                new Point(54.1532,
                                        39.7534,
                                        -146.2162,
                                        -81.9009,
                                        726.6954,
                                    new SpatialReference(3,
                                            "natus",
                                            "eius",
                                            "sit"),
                                        true,
                                        true,
                                        857.6765),
                                    true,
                                    true,
                                    true),
                            new TextSymbol("eum eum doloremque",
                                new MapColor(180, 11, 81),
                                new MapColor(51, 180, 110),
                                    new Dimension(501.9073),
                                new MapFont(new Dimension(273.9539),
                                        "Helvetica",
                                    MapFontStyle.Normal,
                                    FontWeight.Normal,
                                    TextDecoration.None),
                                    758.6153,
                                new MapColor(135, 47, 138),
                                new MapColor(5, 159, 176),
                                    359.2710,
                                HorizontalAlignment.Right,
                                    true,
                                    358.0085,
                                    new Dimension(707.5812),
                                    true),
                            new PopupTemplate("ducimus ullam veniam",
                                    "vitae",
                                    ["veniam"],
                                [new FieldInfo("createdAt",
                                        "harum",
                                        "id",
                                    StringFieldOption.TextArea,
                                    new FieldInfoFormat(7,
                                            true,
                                        DateFormat.DayShortMonthYearLongTime),
                                        true,
                                        true,
                                    StatisticType.Stddev)],
                                [new ExpressionPopupContent(new ElementExpressionInfo("return Date();",
                                            "quis",
                                            "unde ullam similique")),
                                new AttachmentsPopupContent("qui et qui",
                                        "iste id quia",
                                        AttachmentsPopupContentDisplayType.Auto)],
                                [new ExpressionInfo("return $feature.Name;",
                                        "comment",
                                        "quia facere ullam",
                                        ExpressionInfoReturnType.String)],
                                    true,
                                    true,
                                    [new ActionButton("est adipisci odit",
                                        "https://picsum.photos/640/480/?image=775",
                                        "00ba5c12-9c52-2403-7acb-c2b0fc6167c1",
                                        () => { Console.WriteLine("officiis"); return Task.CompletedTask; },
                                        "comment",
                                        true,
                                        true,
                                        true,
                                        "officia")]),
                                new AttributesDictionary(),
                                true,
                                "quo",
                                "a",
                                new GraphicOrigin(Guid.NewGuid(),
                                    "voluptas",
                                    1))],
                            ["officia",
                                "ut"],
                            "quas",
                            29182.1264,
                            43586784.2977,
                            "corporis",
                            FeatureGeometryType.Polyline,
                            "et odio officia",
                            0.8664,
                            true,
                        ListMode.Show,
                        new PopupTemplate("sint est non",
                                "voluptates",
                                ["ut"],
                            [new FieldInfo("email",
                                    "sed",
                                    "molestiae",
                                StringFieldOption.RichText,
                                new FieldInfoFormat(8,
                                        true,
                                    DateFormat.ShortDateLongTime24),
                                    true,
                                    true,
                                StatisticType.Stddev),
                            new FieldInfo("name",
                                    "maxime",
                                    "tenetur",
                                StringFieldOption.TextArea,
                                new FieldInfoFormat(5,
                                        true,
                                    DateFormat.DayShortMonthYearLongTime24),
                                    true,
                                    true,
                                StatisticType.Count)],
                            [new RelationshipPopupContent("adipisci ea odit",
                                    "deleniti at exercitationem",
                                    9,
                                    "impedit",
                                [new RelatedRecordsInfoFieldOrder("quae",
                                    OrderBy.Desc)],
                                    3)],
                            [new ExpressionInfo("return $feature['FieldName'];",
                                    "status",
                                    "consectetur et optio",
                                    ExpressionInfoReturnType.String),
                            new ExpressionInfo("var area = Geometry($feature).area; return area;",
                                    "title",
                                    "quae nam ea",
                                    ExpressionInfoReturnType.String)],
                                true,
                                true,
                                [new ActionButton("consequuntur vitae voluptatem",
                                    "https://picsum.photos/640/480/?image=44",
                                    "e61b9f54-aada-0437-6860-59681b6444df",
                                    () => { Console.WriteLine("numquam"); return Task.CompletedTask; },
                                    "password",
                                    true,
                                    true,
                                    true,
                                    "aut")])),
                    new FeatureLayerView(new LayerView(),
                            new AbortManager(default,
                                new JsModuleManager()),
                        new FeatureEffect([new Effect("nulla",
                                7245622.4669),
                                new Effect("adipisci",
                                    5924171.2853)],
                                true,
                            new FeatureFilter(886.7405,
                                new Point(110.7030,
                                        54.9856,
                                        -9.8680,
                                        -78.4020,
                                        279.3554,
                                    new SpatialReference(7,
                                            "at",
                                            "ad",
                                            "culpa"),
                                        true,
                                        true,
                                        3.2982),
                                    [7],
                                SpatialRelationship.Overlaps,
                                new TimeExtent(new DateTime(2003, 1, 11, 5, 2, 55),
                                        new DateTime(2006, 11, 6, 22, 8, 33)),
                                    QueryUnits.NauticalMiles,
                                    "Province = 'Ontario'"),
                                [new Effect("quos",
                                    37167601.9827),
                                    new Effect("libero",
                                        10441304.2992)]),
                        new FeatureFilter(262.8582,
                            new Polygon([new MapPath([new MapPoint([840.1800])])],
                                new SpatialReference(3,
                                        "molestiae",
                                        "magni",
                                        "dicta"),
                                new Point(-62.8441,
                                        -44.2430,
                                        46.7053,
                                        -77.5287,
                                        121.0013,
                                    new SpatialReference(4,
                                            "doloribus",
                                            "quo",
                                            "vel"),
                                        true,
                                        true,
                                        985.7354),
                                    true,
                                    true,
                                    true),
                                [1],
                            SpatialRelationship.Relation,
                            new TimeExtent(new DateTime(2005, 5, 5, 2, 49, 25),
                                    new DateTime(2023, 10, 3, 12, 30, 10)),
                                QueryUnits.UsNauticalMiles,
                                "Name = 'John Doe'"),
                        new HighlightOptions(new MapColor(141, 253, 249),
                            new MapColor(139, 73, 209),
                                104.7155,
                                270.1110,
                            new MapColor(205, 77, 191),
                                595.8126,
                                861.1264),
                            846.4713,
                            true),
                    [default,
                    default],
                        true,
                        true,
                        8151715.0888,
                        [3,
                            6],
                        "quia doloremque nesciunt",
                        598.6362)],
                    true,
                    true,
                [new LegendViewModelLayerInfos(new GraphicsLayer([new Graphic(new Point(-122.6859,
                                    78.9924,
                                    -4.6498,
                                    -47.1807,
                                    217.8928,
                                new SpatialReference(1,
                                        "itaque",
                                        "voluptas",
                                        "aperiam"),
                                    true,
                                    true,
                                    988.1260),
                            new TextSymbol("et odio dolorem",
                                new MapColor(90, 151, 67),
                                new MapColor(254, 67, 107),
                                    new Dimension(526.6895),
                                new MapFont(new Dimension(534.5474),
                                        "Palatino",
                                    MapFontStyle.Normal,
                                    FontWeight.Bolder,
                                    TextDecoration.LineThrough),
                                    582.9806,
                                new MapColor(112, 158, 135),
                                new MapColor(14, 250, 91),
                                    264.9079,
                                HorizontalAlignment.Right,
                                    true,
                                    148.6598,
                                    new Dimension(835.5255),
                                    true),
                            new PopupTemplate("incidunt tempora voluptatum",
                                    "possimus",
                                    ["nobis",
                                        "neque"],
                                [new FieldInfo("name",
                                        "voluptate",
                                        "aut",
                                    StringFieldOption.TextArea,
                                    new FieldInfoFormat(3,
                                            true,
                                        DateFormat.DayShortMonthYear),
                                        true,
                                        true,
                                    StatisticType.Min),
                                new FieldInfo("email",
                                        "optio",
                                        "voluptas",
                                    StringFieldOption.TextArea,
                                    new FieldInfoFormat(2,
                                            true,
                                        DateFormat.ShortDateLeShortTime24),
                                        true,
                                        true,
                                    StatisticType.Avg)],
                                [new ExpressionPopupContent(new ElementExpressionInfo("var x = $feature.X; var y = $feature.Y; return x + ', ' + y;",
                                            "fuga",
                                            "quam et placeat")),
                                new TextPopupContent("est illum perferendis")],
                                [new ExpressionInfo("return $feature.Status == 'Active' ? 'Active' : 'Inactive';",
                                        "category",
                                        "nisi consectetur error",
                                        ExpressionInfoReturnType.String),
                                new ExpressionInfo("var x = $feature.X; var y = $feature.Y; return x + ', ' + y;",
                                        "email",
                                        "nam alias dolore",
                                        ExpressionInfoReturnType.String)],
                                    true,
                                    true,
                                    [new ActionButton("sit dolores ut",
                                        "https://picsum.photos/640/480/?image=564",
                                        "4b7a2fc3-b5ac-617e-1b3c-88a88353da2f",
                                        () => { Console.WriteLine("optio"); return Task.CompletedTask; },
                                        "name",
                                        true,
                                        true,
                                        true,
                                        "molestias")]),
                                new AttributesDictionary(),
                                true,
                                "ipsum",
                                "voluptatem",
                                new GraphicOrigin(Guid.NewGuid(),
                                    "quidem",
                                    9))],
                            "harum sit qui",
                            0.7166,
                            true,
                        ListMode.Hide,
                            true,
                            2433.1324,
                            33149238.5795,
                            true,
                        BlendMode.Reflect,
                            new Effect("commodi",
                                408946.9482),
                        new GraphicsLayerElevationInfo(new GraphicsLayerElevationInfoFeatureExpressionInfo("var length = Geometry($feature).length; return length;",
                                    "fuga odit rerum"),
                            ElevationInfoMode.AbsoluteHeight,
                                674.6361,
                            ElevationUnit.Decimeters),
                        new Extent(118.7298,
                                132.2384,
                                -12.5836,
                                -9.8853,
                                603.6572,
                                675.8467,
                                767.9858,
                                617.8801,
                            new SpatialReference(9,
                                    "et",
                                    "corporis",
                                    "voluptates"),
                                true,
                                true),
                        new TimeExtent(new DateTime(2012, 11, 12, 22, 32, 47),
                                new DateTime(2003, 11, 12, 21, 9, 34))),
                        "quis molestias distinctio"),
                new LegendViewModelLayerInfos(new BaseTileLayer(BlendMode.SourceIn,
                            new Effect("qui",
                                44565167.8962),
                            40636080.7563,
                            31046.2984,
                            242.4042,
                        new SpatialReference(1,
                                "explicabo",
                                "voluptates",
                                "porro"),
                        new Extent(101.8006,
                                122.6976,
                                37.5707,
                                60.3575,
                                533.6822,
                                401.4278,
                                844.0754,
                                651.0567,
                            new SpatialReference(4,
                                    "beatae",
                                    "voluptas",
                                    "nulla"),
                                true,
                                true),
                        ListMode.Show,
                            0.2497,
                            true,
                        new TileInfo(201.6129,
                                TileInfoFormat.Emf,
                                true,
                            [new LOD(5,
                                    "qui",
                                    9.6776,
                                    45172922.2249)],
                            new Point(-129.0298,
                                    -70.2221,
                                    -84.2007,
                                    20.7211,
                                    659.6425,
                                new SpatialReference(3,
                                        "sapiente",
                                        "et",
                                        "in"),
                                    true,
                                    true,
                                    334.2408),
                                [2],
                            new SpatialReference(9,
                                    "nam",
                                    "illum",
                                    "enim")),
                            "illum dolores atque",
                        new TimeExtent(new DateTime(2013, 5, 7, 7, 39, 0),
                                new DateTime(2011, 5, 7, 3, 34, 47))),
                        "aspernatur facere aperiam")],
                    true);
        await legendWidget.SetViewModel(testViewModel);
        var viewModel = await legendWidget.GetViewModel();
        Assert.AreEqual(testViewModel, viewModel);
    }
}
