@inherits TestRunnerBase

@{
    base.BuildRenderTree(__builder);
}

@code {

    [TestMethod]
    public async Task TestCanRenderGeneratedGraphicsLayer(Action renderHandler)
    {
        GraphicsLayer? graphicsLayer = null;

        AddMapRenderFragment(
            @<MapView class="map-view" OnViewRendered="renderHandler">
                <Map>
                    <Basemap>
                        <BasemapStyle Name="BasemapStyleName.ArcgisTopographic" />
                    </Basemap>
                    <GraphicsLayer 
                        Title="@("tempore eius et")"
                        Opacity="@(0.2467)"
                        Visible="@(true)"
                        ListMode="@(ListMode.Show)"
                        PersistenceEnabled="@(true)"
                        MinScale="@(18690.4763)"
                        MaxScale="@(34730532.6959)"
                        ScreenSizePerspectiveEnabled="@(true)"
                        BlendMode="@(BlendMode.SoftLight)"
                        Effect="@(new Effect("unde",
                            29765117.0624))"
                        FullExtent="@(new Extent(139.1949,
                                23.6636,
                                47.0945,
                                -45.9481,
                                486.1772,
                                953.7199,
                                830.9963,
                                772.3702,
                            new SpatialReference(6,
                                    "doloribus",
                                    "dolor",
                                    "veniam"),
                                true,
                                true))">
                        <TimeExtent 
                            Start="@(new DateTime(2007, 11, 11, 2, 1, 17))"
                            End="@(new DateTime(2021, 9, 21, 3, 58, 34))">
                        </TimeExtent>
                        <Graphic 
                            Geometry="@(new Point(60.2656,
                                    -58.9180,
                                    -2.3478,
                                    19.5150,
                                    135.6956,
                                new SpatialReference(9,
                                        "quae",
                                        "est",
                                        "fugit"),
                                    true,
                                    true,
                                    856.3521))"
                            Symbol="@(new TextSymbol("adipisci qui ratione",
                                new MapColor(89, 198, 183),
                                new MapColor(117, 63, 189),
                                    new Dimension(37.5652),
                                new MapFont(new Dimension(958.3361),
                                        "Georgia",
                                    MapFontStyle.Italic,
                                    FontWeight.Normal,
                                    TextDecoration.LineThrough),
                                    747.6832,
                                new MapColor(165, 117, 202),
                                new MapColor(159, 25, 117),
                                    842.2924,
                                HorizontalAlignment.Right,
                                    true,
                                    173.7813,
                                    new Dimension(490.6355),
                                    true))"
                            PopupTemplate="@(new PopupTemplate("ab velit non",
                                    "nihil",
                                    ["nulla",
                                        "architecto"],
                                [new FieldInfo("title",
                                        "nam",
                                        "dolor",
                                    StringFieldOption.TextBox,
                                    new FieldInfoFormat(7,
                                            true,
                                        DateFormat.LongMonthDayYearShortTime24),
                                        true,
                                        true,
                                    StatisticType.Count),
                                new FieldInfo("group",
                                        "perspiciatis",
                                        "assumenda",
                                    StringFieldOption.RichText,
                                    new FieldInfoFormat(1,
                                            true,
                                        DateFormat.LongDateLongTime24),
                                        true,
                                        true,
                                    StatisticType.Count)],
                                [new TextPopupContent("aperiam quos voluptas")],
                                [new ExpressionInfo("var length = Geometry($feature).length; return length;",
                                        "comment",
                                        "ipsum nisi impedit",
                                        ExpressionInfoReturnType.String),
                                new ExpressionInfo("return $feature.Status == 'Active' ? 'Active' : 'Inactive';",
                                        "title",
                                        "veritatis numquam aut",
                                        ExpressionInfoReturnType.String),
                                new ExpressionInfo("return $feature.Status == 'Active' ? 'Active' : 'Inactive';",
                                        "updatedAt",
                                        "sint cum qui",
                                        ExpressionInfoReturnType.String),
                                new ExpressionInfo("return $feature['FieldName'];",
                                        "title",
                                        "corrupti recusandae totam",
                                        ExpressionInfoReturnType.String)],
                                    true,
                                    true,
                                [new ActionButton("et suscipit cumque",
                                        "https://picsum.photos/640/480/?image=560",
                                        "a73b1d47-2d33-55c9-ef1b-b0274a986dd1",
                                        () => { Console.WriteLine("magnam"); return Task.CompletedTask; },
                                        "password",
                                        true,
                                        true,
                                        true,
                                        "quia")]))"
                            Attributes="@(new AttributesDictionary())"
                            Visible="@(true)"
                            LegendLabel="@("maiores")"
                            AggregateGeometries="@("aspernatur")"
                            Origin="@(new GraphicOrigin(Guid.NewGuid(),
                                "officia",
                                9))">
                        </Graphic>
                        <GraphicsLayerElevationInfo 
                            FeatureExpressionInfo="@(new GraphicsLayerElevationInfoFeatureExpressionInfo("return $feature.Name;",
                                    "sint qui repellat"))"
                            Mode="@(ElevationInfoMode.AbsoluteHeight)"
                            Offset="@(669.2618)"
                            Unit="@(ElevationUnit.NauticalMiles)">
                        </GraphicsLayerElevationInfo>
                    </GraphicsLayer>
                </Map>
            </MapView>);
        await WaitForMapToRender();
        Assert.IsNotNull(graphicsLayer!);
        await AssertJavaScript("assertLayerExists", args: "graphics");
        await graphicsLayer.AddMany([new Graphic(new Polygon([new MapPath([new MapPoint([273.4890,
                            805.7742]),
                        new MapPoint([752.1632,
                            731.6381]),
                        new MapPoint([274.1260,
                            842.9756])]),
                        new MapPath([new MapPoint([25.6302,
                                151.0176,
                                519.3274,
                                835.1890]),
                            new MapPoint([568.6274,
                                987.7759,
                                112.0559,
                                143.2331]),
                            new MapPoint([89.2841,
                                310.4419,
                                897.0842,
                                116.6731]),
                            new MapPoint([279.7324,
                                735.5776,
                                365.7860])])],
                    new SpatialReference(7,
                            "consequatur",
                            "sapiente",
                            "autem"),
                    new Point(-134.4327,
                            -40.1490,
                            160.8813,
                            33.9078,
                            806.1796,
                        new SpatialReference(5,
                                "ipsum",
                                "qui",
                                "sit"),
                            true,
                            true,
                            187.7920),
                        true,
                        true,
                        true),
                new TextSymbol("dolores porro aut",
                    new MapColor(50, 188, 48),
                    new MapColor(19, 233, 76),
                        new Dimension(879.3711),
                    new MapFont(new Dimension(569.5731),
                            "Courier New",
                        MapFontStyle.Oblique,
                        FontWeight.Bold,
                        TextDecoration.None),
                        960.6059,
                    new MapColor(111, 122, 224),
                    new MapColor(156, 35, 144),
                        291.1179,
                    HorizontalAlignment.Right,
                        true,
                        182.3798,
                        new Dimension(549.6902),
                        true),
                new PopupTemplate("dicta occaecati error",
                        "rem",
                        ["architecto",
                            "nemo",
                            "et"],
                    [new FieldInfo("avatar",
                            "aut",
                            "perspiciatis",
                        StringFieldOption.TextBox,
                        new FieldInfoFormat(3,
                                true,
                            DateFormat.DayShortMonthYearLongTime),
                            true,
                            true,
                        StatisticType.Min),
                    new FieldInfo("avatar",
                            "et",
                            "nulla",
                        StringFieldOption.TextArea,
                        new FieldInfoFormat(1,
                                true,
                            DateFormat.LongMonthDayYearLongTime),
                            true,
                            true,
                        StatisticType.Min)],
                    [new MediaPopupContent("et voluptatem adipisci",
                            "beatae in aut sunt maiores quisquam itaque",
                        [new LineChartMediaInfo("voluptates saepe ab",
                                "quia",
                                "et qui dolorem",
                            new ChartMediaInfoValue(["aperiam",
                                    "odio",
                                    "voluptatum",
                                    "sapiente"],
                                    "natus",
                                    "velit",
                                [new ChartMediaInfoValueSeries("token",
                                        "voluptatem",
                                        568.6639)],
                                [new MapColor(115, 73, 27),
                                new MapColor(84, 188, 7)])),
                        new LineChartMediaInfo("et enim accusamus",
                                "itaque",
                                "voluptatibus neque et",
                            new ChartMediaInfoValue(["omnis",
                                    "reiciendis",
                                    "debitis",
                                    "est"],
                                    "suscipit",
                                    "et",
                                [new ChartMediaInfoValueSeries("title",
                                        "corporis",
                                        738.0239)],
                                [new MapColor(251, 235, 236),
                                new MapColor(75, 129, 233)]))],
                            9),
                    new MediaPopupContent("aliquid magnam et",
                            "possimus tempore totam assumenda eum qui",
                        [new ImageMediaInfo("est molestiae rem",
                                "aperiam",
                                "quia impedit enim",
                            new ImageMediaInfoValue("https://laurine.biz",
                                    "https://richard.info"),
                                513.7981),
                        new LineChartMediaInfo("a ipsa nesciunt",
                                "sit",
                                "ut et commodi",
                            new ChartMediaInfoValue(["facilis",
                                    "sit",
                                    "provident",
                                    "iusto"],
                                    "quasi",
                                    "iusto",
                                [new ChartMediaInfoValueSeries("createdAt",
                                        "omnis",
                                        353.5196),
                                new ChartMediaInfoValueSeries("updatedAt",
                                        "sed",
                                        785.8698)],
                                [new MapColor(230, 22, 247),
                                new MapColor(67, 58, 195)])),
                        new PieChartMediaInfo("nihil sapiente nihil",
                                "repellendus",
                                "a quis voluptatem",
                            new ChartMediaInfoValue(["voluptatem",
                                    "ea",
                                    "neque",
                                    "ea"],
                                    "atque",
                                    "dolore",
                                [new ChartMediaInfoValueSeries("updatedAt",
                                        "voluptas",
                                        996.7822)],
                                [new MapColor(112, 90, 252)])),
                        new LineChartMediaInfo("est dolorem et",
                                "saepe",
                                "suscipit culpa eum",
                            new ChartMediaInfoValue(["facilis",
                                    "repellendus",
                                    "eos",
                                    "voluptates"],
                                    "in",
                                    "porro",
                                [new ChartMediaInfoValueSeries("comment",
                                        "laboriosam",
                                        756.9120),
                                new ChartMediaInfoValueSeries("updatedAt",
                                        "aut",
                                        74.2384),
                                new ChartMediaInfoValueSeries("comment",
                                        "rem",
                                        438.1527)],
                                [new MapColor(56, 130, 69)]))],
                            3),
                    new RelationshipPopupContent("voluptates laborum facilis",
                            "enim voluptas quam facilis",
                            6,
                            "maxime",
                        [new RelatedRecordsInfoFieldOrder("eaque",
                            OrderBy.Asc),
                        new RelatedRecordsInfoFieldOrder("dicta",
                            OrderBy.Desc)],
                            3)],
                    [new ExpressionInfo("if ($feature.Age > 21) { return 'Adult'; } else { return 'Minor'; }",
                            "email",
                            "aspernatur sapiente inventore",
                            ExpressionInfoReturnType.String)],
                        true,
                        true,
                    [new ActionToggle("nisi dolore itaque",
                            "66b5421c-2afa-6af5-8f0f-26b11b1d5a74",
                            () => { Console.WriteLine("nisi"); return Task.CompletedTask; },
                            true,
                            true,
                            true,
                            true,
                            "phone",
                            "ut"),
                    new ActionButton("blanditiis quia odit",
                            "https://picsum.photos/640/480/?image=429",
                            "2bcf5a3e-ea24-b3fe-7171-df12cc41c08f",
                            () => { Console.WriteLine("adipisci"); return Task.CompletedTask; },
                            "title",
                            true,
                            true,
                            true,
                            "et"),
                    new ActionToggle("porro quasi qui",
                            "fb5e9ec0-1428-40fd-60a9-d28440b07a65",
                            () => { Console.WriteLine("et"); return Task.CompletedTask; },
                            true,
                            true,
                            true,
                            true,
                            "token",
                            "dolor"),
                    new ActionToggle("quasi tempora voluptate",
                            "2f9b7c43-1416-83af-1095-947cb41b17ea",
                            () => { Console.WriteLine("molestias"); return Task.CompletedTask; },
                            true,
                            true,
                            true,
                            true,
                            "group",
                            "ut")]),
                    new AttributesDictionary(),
                    true,
                    "provident",
                    "quas",
                    new GraphicOrigin(Guid.NewGuid(),
                        "ex",
                        2))]);
        await graphicsLayer.RemoveAll();
        await graphicsLayer.RemoveMany([new Graphic(new Polygon([new MapPath([new MapPoint([649.3660,
                            322.0546,
                            633.0767]),
                        new MapPoint([145.7903,
                            975.1273,
                            418.1245,
                            117.0774]),
                        new MapPoint([334.8182,
                            188.8890,
                            187.3254])]),
                        new MapPath([new MapPoint([376.6364,
                                43.5716,
                                942.3299]),
                            new MapPoint([623.5712,
                                531.4969,
                                649.8802,
                                758.1022]),
                            new MapPoint([337.9787,
                                149.6301,
                                76.0458]),
                            new MapPoint([700.8868,
                                178.2306])])],
                    new SpatialReference(1,
                            "hic",
                            "architecto",
                            "ut"),
                    new Point(88.4620,
                            -7.7366,
                            -156.7845,
                            -72.2570,
                            400.8990,
                        new SpatialReference(5,
                                "quia",
                                "amet",
                                "sit"),
                            true,
                            true,
                            496.0518),
                        true,
                        true,
                        true),
                new TextSymbol("minus sit beatae",
                    new MapColor(116, 179, 21),
                    new MapColor(103, 94, 212),
                        new Dimension(587.4714),
                    new MapFont(new Dimension(143.4916),
                            "Arial",
                        MapFontStyle.Italic,
                        FontWeight.Normal,
                        TextDecoration.Underline),
                        239.5911,
                    new MapColor(53, 228, 215),
                    new MapColor(33, 151, 37),
                        78.2466,
                    HorizontalAlignment.Left,
                        true,
                        258.9103,
                        new Dimension(708.7730),
                        true),
                new PopupTemplate("ipsum soluta ex",
                        "maxime",
                        ["doloremque",
                            "ipsum"],
                    [new FieldInfo("updatedAt",
                            "a",
                            "voluptatem",
                        StringFieldOption.TextArea,
                        new FieldInfoFormat(5,
                                true,
                            DateFormat.DayShortMonthYearShortTime24),
                            true,
                            true,
                        StatisticType.Max),
                    new FieldInfo("id",
                            "voluptas",
                            "harum",
                        StringFieldOption.TextBox,
                        new FieldInfoFormat(2,
                                true,
                            DateFormat.LongMonthDayYearLongTime),
                            true,
                            true,
                        StatisticType.Min),
                    new FieldInfo("createdAt",
                            "sequi",
                            "corrupti",
                        StringFieldOption.TextBox,
                        new FieldInfoFormat(7,
                                true,
                            DateFormat.ShortDateLeLongTime24),
                            true,
                            true,
                        StatisticType.Avg)],
                    [new RelationshipPopupContent("recusandae facere facilis",
                            "at ducimus voluptas labore sit excepturi sed",
                            5,
                            "soluta",
                        [new RelatedRecordsInfoFieldOrder("praesentium",
                            OrderBy.Desc),
                        new RelatedRecordsInfoFieldOrder("atque",
                            OrderBy.Desc)],
                            7),
                    new TextPopupContent("vel quam porro"),
                    new MediaPopupContent("a facilis qui",
                            "fuga laborum amet nihil quo",
                        [new PieChartMediaInfo("totam quae voluptates",
                                "sit",
                                "exercitationem quod sed",
                            new ChartMediaInfoValue(["tenetur",
                                    "sapiente",
                                    "officia"],
                                    "illum",
                                    "quod",
                                [new ChartMediaInfoValueSeries("token",
                                        "et",
                                        826.6061),
                                new ChartMediaInfoValueSeries("token",
                                        "quas",
                                        991.2668),
                                new ChartMediaInfoValueSeries("status",
                                        "velit",
                                        671.5638)],
                                [new MapColor(90, 72, 29),
                                new MapColor(48, 193, 207),
                                new MapColor(143, 184, 78),
                                new MapColor(0, 225, 164)])),
                        new ImageMediaInfo("minus temporibus nostrum",
                                "odit",
                                "enim sapiente officia",
                            new ImageMediaInfoValue("http://serena.net",
                                    "http://soledad.name"),
                                215.8962),
                        new PieChartMediaInfo("ut est quaerat",
                                "rerum",
                                "totam fugiat corrupti",
                            new ChartMediaInfoValue(["ea",
                                    "alias",
                                    "cumque",
                                    "quasi"],
                                    "optio",
                                    "illum",
                                [new ChartMediaInfoValueSeries("avatar",
                                        "temporibus",
                                        306.8462)],
                                [new MapColor(250, 245, 237),
                                new MapColor(212, 25, 245),
                                new MapColor(156, 185, 243),
                                new MapColor(1, 220, 166)])),
                        new PieChartMediaInfo("et et ut",
                                "earum",
                                "tempora ipsa dolorem",
                            new ChartMediaInfoValue(["voluptas",
                                    "animi"],
                                    "temporibus",
                                    "necessitatibus",
                                [new ChartMediaInfoValueSeries("comment",
                                        "id",
                                        559.8307),
                                new ChartMediaInfoValueSeries("avatar",
                                        "sequi",
                                        3.1676),
                                new ChartMediaInfoValueSeries("updatedAt",
                                        "eius",
                                        796.1317)],
                                [new MapColor(75, 101, 9),
                                new MapColor(213, 205, 157),
                                new MapColor(110, 1, 47),
                                new MapColor(134, 171, 38)]))],
                            6),
                    new FieldsPopupContent([new FieldInfo("title",
                                "consequuntur",
                                "nostrum",
                            StringFieldOption.TextBox,
                            new FieldInfoFormat(5,
                                    true,
                                DateFormat.ShortDateLeLongTime24),
                                true,
                                true,
                            StatisticType.Avg),
                        new FieldInfo("token",
                                "ut",
                                "autem",
                            StringFieldOption.RichText,
                            new FieldInfoFormat(6,
                                    true,
                                DateFormat.LongMonthDayYearLongTime),
                                true,
                                true,
                            StatisticType.Avg),
                        new FieldInfo("password",
                                "est",
                                "natus",
                            StringFieldOption.TextBox,
                            new FieldInfoFormat(2,
                                    true,
                                DateFormat.LongMonthDayYearShortTime24),
                                true,
                                true,
                            StatisticType.Count),
                        new FieldInfo("token",
                                "molestiae",
                                "at",
                            StringFieldOption.RichText,
                            new FieldInfoFormat(7,
                                    true,
                                DateFormat.LongMonthDayYearShortTime24),
                                true,
                                true,
                            StatisticType.Max)],
                            "dolore sapiente nam deleniti fugiat",
                            "odio laudantium earum")],
                    [new ExpressionInfo("return Date();",
                            "createdAt",
                            "nisi et et",
                            ExpressionInfoReturnType.String),
                    new ExpressionInfo("var length = Geometry($feature).length; return length;",
                            "updatedAt",
                            "in molestiae est",
                            ExpressionInfoReturnType.String)],
                        true,
                        true,
                    [new ActionToggle("modi dolor repudiandae",
                            "a59348b6-fbab-26ae-c754-72351cbdb3bb",
                            () => { Console.WriteLine("ipsa"); return Task.CompletedTask; },
                            true,
                            true,
                            true,
                            true,
                            "title",
                            "voluptatem")]),
                    new AttributesDictionary(),
                    true,
                    "minus",
                    "sed",
                    new GraphicOrigin(Guid.NewGuid(),
                        "ipsam",
                        3))]);
        ListMode testListMode = ListMode.Show;
        await graphicsLayer.SetListMode(testListMode);
        var listMode = await graphicsLayer.GetListMode();
        Assert.AreEqual(testListMode, listMode);
        BlendMode testBlendMode = BlendMode.Exclusion;
        await graphicsLayer.SetBlendMode(testBlendMode);
        var blendMode = await graphicsLayer.GetBlendMode();
        Assert.AreEqual(testBlendMode, blendMode);
        GraphicsLayerElevationInfo testElevationInfo = new GraphicsLayerElevationInfo(new GraphicsLayerElevationInfoFeatureExpressionInfo("var area = Geometry($feature).area; return area;",
                        "odio suscipit est"),
                ElevationInfoMode.OnTheGround,
                    751.9192,
                ElevationUnit.Feet);
        await graphicsLayer.SetElevationInfo(testElevationInfo);
        var elevationInfo = await graphicsLayer.GetElevationInfo();
        Assert.AreEqual(testElevationInfo, elevationInfo);
        Extent testFullExtent = new Extent(153.3892,
                    -1.7967,
                    -68.8909,
                    -23.4365,
                    943.6386,
                    68.2144,
                    948.4806,
                    42.0301,
                new SpatialReference(7,
                        "dolor",
                        "qui",
                        "officiis"),
                    true,
                    true);
        await graphicsLayer.SetFullExtent(testFullExtent);
        var fullExtent = await graphicsLayer.GetFullExtent();
        Assert.AreEqual(testFullExtent, fullExtent);
        TimeExtent testVisibilityTimeExtent = new TimeExtent(new DateTime(2019, 9, 22, 10, 49, 24),
                    new DateTime(2022, 2, 21, 21, 3, 38));
        await graphicsLayer.SetVisibilityTimeExtent(testVisibilityTimeExtent);
        var visibilityTimeExtent = await graphicsLayer.GetVisibilityTimeExtent();
        Assert.AreEqual(testVisibilityTimeExtent, visibilityTimeExtent);
    }
}
