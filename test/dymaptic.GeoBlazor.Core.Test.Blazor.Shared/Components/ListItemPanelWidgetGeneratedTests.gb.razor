@inherits TestRunnerBase

@{
    base.BuildRenderTree(__builder);
}

@code {

    [TestMethod]
    public async Task TestCanRenderGeneratedListItemPanelWidget(Action renderHandler)
    {
        ListItemPanelWidget? listItemPanelWidget = null;

        AddMapRenderFragment(
            @<MapView class="map-view" OnViewRendered="renderHandler">
                <Map>
                    <Basemap>
                        <BasemapStyle Name="BasemapStyleName.ArcgisTopographic" />
                    </Basemap>
                </Map>
                <ListItemPanelWidget 
                    Disabled="@(true)"
                    FlowEnabled="@(true)"
                    Icon="@("ut")"
                    Image="@("https://picsum.photos/640/480/?image=929")"
                    Label="@("qui")"
                    Open="@(true)"
                    Title="@("officiis animi pariatur")"
                    WidgetId="@("id")">
                    <ListItem 
                        ActionsOpen="@(true)"
                        ActionsSections="@(new ActionButton("in dolores aut",
                            "https://picsum.photos/640/480/?image=320",
                            "14d01cbd-5089-20f3-8e7d-f0f60b5e0038",
                            () => { Console.WriteLine("debitis"); return Task.CompletedTask; },
                            "category",
                            true,
                            true,
                            true,
                            "aliquid"))"
                        ChildrenSortable="@(true)"
                        Hidden="@(true)"
                        Layer="@(new FeatureLayer("https://sampleserver6.arcgisonline.com/arcgis/rest/services/Hurricanes/MapServer/1",
                            new PortalItem(),
                            [new Graphic(new Extent(62.7650,
                                        -16.1044,
                                        84.9867,
                                        48.9211,
                                        611.2356,
                                        794.3904,
                                        101.3249,
                                        980.4473,
                                    new SpatialReference(8,
                                            "eos",
                                            "quod",
                                            "deserunt"),
                                        true,
                                        true),
                                new TextSymbol("dolorem sunt recusandae",
                                    new MapColor(44, 219, 127),
                                    new MapColor(58, 53, 191),
                                        new Dimension(696.7094),
                                    new MapFont(new Dimension(296.9403),
                                            "Georgia",
                                        MapFontStyle.Normal,
                                        FontWeight.Bolder,
                                        TextDecoration.LineThrough),
                                        722.0188,
                                    new MapColor(216, 18, 80),
                                    new MapColor(62, 195, 70),
                                        28.1294,
                                    HorizontalAlignment.Left,
                                        true,
                                        15.3341,
                                        new Dimension(242.5187),
                                        true),
                                new PopupTemplate("vel reprehenderit adipisci",
                                        "sapiente",
                                        ["et",
                                            "enim"],
                                    [new FieldInfo("status",
                                            "praesentium",
                                            "ratione",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(3,
                                                true,
                                            DateFormat.DayShortMonthYear),
                                            true,
                                            true,
                                        StatisticType.Sum),
                                    new FieldInfo("comment",
                                            "facilis",
                                            "pariatur",
                                        StringFieldOption.RichText,
                                        new FieldInfoFormat(5,
                                                true,
                                            DateFormat.ShortDateLe),
                                            true,
                                            true,
                                        StatisticType.Sum)],
                                    [new FieldsPopupContent([new FieldInfo("group",
                                                "eius",
                                                "omnis",
                                            StringFieldOption.TextArea,
                                            new FieldInfoFormat(9,
                                                    true,
                                                DateFormat.LongDateLongTime),
                                                true,
                                                true,
                                            StatisticType.Var),
                                        new FieldInfo("createdAt",
                                                "porro",
                                                "quasi",
                                            StringFieldOption.TextArea,
                                            new FieldInfoFormat(6,
                                                    true,
                                                DateFormat.ShortDateShortTime),
                                                true,
                                                true,
                                            StatisticType.Sum)],
                                            "provident facilis debitis ut",
                                            "et enim tempore"),
                                    new RelationshipPopupContent("labore voluptatem iure",
                                            "aliquam sunt",
                                            4,
                                            "ab",
                                        [new RelatedRecordsInfoFieldOrder("velit",
                                            OrderBy.Asc)],
                                            4)],
                                    [new ExpressionInfo("if ($feature.Age > 21) { return 'Adult'; } else { return 'Minor'; }",
                                            "updatedAt",
                                            "rerum possimus necessitatibus",
                                            ExpressionInfoReturnType.String),
                                    new ExpressionInfo("return Date();",
                                            "status",
                                            "officiis facere nihil",
                                            ExpressionInfoReturnType.String)],
                                        true,
                                        true,
                                        [new ActionButton("tempore molestias nihil",
                                            "https://picsum.photos/640/480/?image=694",
                                            "73af30ab-12fc-230f-ac9d-2581650bb03e",
                                            () => { Console.WriteLine("qui"); return Task.CompletedTask; },
                                            "title",
                                            true,
                                            true,
                                            true,
                                            "ut"),
                                            new ActionButton("sunt sit sed",
                                                "https://picsum.photos/640/480/?image=176",
                                                "8e76c1e5-e6ad-2b74-31af-ed36b2d8d055",
                                                () => { Console.WriteLine("voluptatibus"); return Task.CompletedTask; },
                                                "password",
                                                true,
                                                true,
                                                true,
                                                "dolorum")]),
                                    new AttributesDictionary(),
                                    true,
                                    "fugiat",
                                    "autem",
                                    new GraphicOrigin(Guid.NewGuid(),
                                        "enim",
                                        5)),
                            new Graphic(new Point(-129.7817,
                                        0.2110,
                                        137.0732,
                                        60.3281,
                                        463.1506,
                                    new SpatialReference(1,
                                            "explicabo",
                                            "vero",
                                            "voluptates"),
                                        true,
                                        true,
                                        749.6985),
                                new TextSymbol("aut qui ea",
                                    new MapColor(27, 129, 120),
                                    new MapColor(42, 138, 127),
                                        new Dimension(996.0166),
                                    new MapFont(new Dimension(693.4983),
                                            "Garamond",
                                        MapFontStyle.Italic,
                                        FontWeight.Normal,
                                        TextDecoration.Underline),
                                        583.0219,
                                    new MapColor(15, 225, 57),
                                    new MapColor(3, 42, 86),
                                        545.7087,
                                    HorizontalAlignment.Left,
                                        true,
                                        379.4841,
                                        new Dimension(242.1789),
                                        true),
                                new PopupTemplate("et illum libero",
                                        "odit",
                                        ["quo"],
                                    [new FieldInfo("name",
                                            "maxime",
                                            "libero",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(9,
                                                true,
                                            DateFormat.LongMonthDayYearLongTime),
                                            true,
                                            true,
                                        StatisticType.Max)],
                                    [new MediaPopupContent("suscipit ab qui",
                                            "occaecati et veritatis dolor",
                                        [new LineChartMediaInfo("provident autem occaecati",
                                                "et",
                                                "dolorem aut autem",
                                            new ChartMediaInfoValue(["omnis",
                                                    "dolorem"],
                                                    "mollitia",
                                                    "accusantium",
                                                [new ChartMediaInfoValueSeries("phone",
                                                        "ratione",
                                                        47.8735),
                                                new ChartMediaInfoValueSeries("title",
                                                        "exercitationem",
                                                        47.9259)],
                                                [new MapColor(245, 1, 18)])),
                                        new PieChartMediaInfo("maxime et consequatur",
                                                "accusamus",
                                                "laborum rerum non",
                                            new ChartMediaInfoValue(["animi"],
                                                    "aliquid",
                                                    "enim",
                                                [new ChartMediaInfoValueSeries("title",
                                                        "reprehenderit",
                                                        969.3954),
                                                new ChartMediaInfoValueSeries("token",
                                                        "a",
                                                        11.3780)],
                                                [new MapColor(23, 11, 219)]))],
                                            1),
                                    new MediaPopupContent("laborum consectetur quam",
                                            "aliquam ea sit",
                                        [new PieChartMediaInfo("ut quia dignissimos",
                                                "consequatur",
                                                "molestias consectetur doloremque",
                                            new ChartMediaInfoValue(["deserunt"],
                                                    "dignissimos",
                                                    "harum",
                                                [new ChartMediaInfoValueSeries("updatedAt",
                                                        "fuga",
                                                        224.9129),
                                                new ChartMediaInfoValueSeries("group",
                                                        "maxime",
                                                        774.5789)],
                                                [new MapColor(154, 170, 169)]))],
                                            6)],
                                    [new ExpressionInfo("if ($feature.Age > 21) { return 'Adult'; } else { return 'Minor'; }",
                                            "comment",
                                            "blanditiis sunt facere",
                                            ExpressionInfoReturnType.String)],
                                        true,
                                        true,
                                        [new ActionButton("perferendis sit odio",
                                            "https://picsum.photos/640/480/?image=1068",
                                            "f0ffb177-083e-2494-1383-9ed13112a5b6",
                                            () => { Console.WriteLine("nam"); return Task.CompletedTask; },
                                            "title",
                                            true,
                                            true,
                                            true,
                                            "aut")]),
                                    new AttributesDictionary(),
                                    true,
                                    "dicta",
                                    "est",
                                    new GraphicOrigin(Guid.NewGuid(),
                                        "quia",
                                        5))],
                                ["ea"],
                                "laudantium",
                                11523.1005,
                                47222932.1047,
                                "adipisci",
                                FeatureGeometryType.Polygon,
                                "enim magnam cupiditate",
                                0.7711,
                                true,
                            ListMode.Hide,
                            new PopupTemplate("ducimus ipsum quas",
                                    "nesciunt",
                                    ["ipsa",
                                        "officiis"],
                                [new FieldInfo("avatar",
                                        "perferendis",
                                        "in",
                                    StringFieldOption.TextBox,
                                    new FieldInfoFormat(8,
                                            true,
                                        DateFormat.LongMonthYear),
                                        true,
                                        true,
                                    StatisticType.Max),
                                new FieldInfo("createdAt",
                                        "vel",
                                        "qui",
                                    StringFieldOption.TextArea,
                                    new FieldInfoFormat(4,
                                            true,
                                        DateFormat.ShortDateLeLongTime),
                                        true,
                                        true,
                                    StatisticType.Sum)],
                                [new RelationshipPopupContent("perspiciatis dolor eveniet",
                                        "perspiciatis dignissimos",
                                        9,
                                        "ea",
                                    [new RelatedRecordsInfoFieldOrder("dolorum",
                                        OrderBy.Desc),
                                    new RelatedRecordsInfoFieldOrder("autem",
                                        OrderBy.Desc)],
                                        2),
                                new RelationshipPopupContent("tempore sint expedita",
                                        "dolorem quasi qui nihil",
                                        6,
                                        "praesentium",
                                    [new RelatedRecordsInfoFieldOrder("reprehenderit",
                                        OrderBy.Desc)],
                                        3)],
                                [new ExpressionInfo("return $feature['FieldName'];",
                                        "phone",
                                        "suscipit saepe nihil",
                                        ExpressionInfoReturnType.String)],
                                    true,
                                    true,
                                    [new ActionButton("perferendis adipisci a",
                                        "https://picsum.photos/640/480/?image=154",
                                        "6605a2ab-ce49-54d5-2de9-36f31340b52a",
                                        () => { Console.WriteLine("eos"); return Task.CompletedTask; },
                                        "comment",
                                        true,
                                        true,
                                        true,
                                        "ducimus"),
                                        new ActionButton("necessitatibus quod fugiat",
                                            "https://picsum.photos/640/480/?image=420",
                                            "e586462f-bb03-6a07-f5f9-5e7e3813298e",
                                            () => { Console.WriteLine("necessitatibus"); return Task.CompletedTask; },
                                            "id",
                                            true,
                                            true,
                                            true,
                                            "aut")])))"
                        ListModeDisabled="@(true)"
                        Open="@(true)"
                        Sortable="@(true)"
                        Title="@("excepturi quaerat est")">
                    </ListItem>
                </ListItemPanelWidget>
            </MapView>);
        await WaitForMapToRender();
        Assert.IsNotNull(listItemPanelWidget!);
        await AssertJavaScript("assertWidgetExists", args: "list-item-panel");
        ListItem testListItem = new ListItem(true,
                    new ActionButton("rerum minus sint",
                        "https://picsum.photos/640/480/?image=551",
                        "98408fe8-639f-2f46-118d-aba8ce001b38",
                        () => { Console.WriteLine("non"); return Task.CompletedTask; },
                        "createdAt",
                        true,
                        true,
                        true,
                        "impedit"),
                    true,
                    true,
                new GeoJSONLayer("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson",
                        "ad",
                        "voluptatibus dolor ipsa",
                        0.0706,
                        true,
                    ListMode.Hide,
                    BlendMode.DestinationIn,
                        default,
                        "adipisci",
                        "repellat",
                        true,
                        new Effect("nobis",
                            4519874.8785),
                    new GeoJSONLayerElevationInfo(new GeoJSONLayerElevationInfoFeatureExpressionInfo("return $feature.City + ', ' + $feature.Country;",
                                "consequuntur animi saepe"),
                        ElevationInfoMode.AbsoluteHeight,
                            899.1566,
                        ElevationUnit.Decimeters),
                    new FeatureEffect([new Effect("tempora",
                            26225053.1022)],
                            true,
                        new FeatureFilter(129.4881,
                            new Polyline([new MapPath([new MapPoint([1.0385]),
                                    new MapPoint([195.0650,
                                        761.7149])]),
                                    new MapPath([new MapPoint([138.4611,
                                            293.4964]),
                                        new MapPoint([952.9491,
                                            584.5348])])],
                                new SpatialReference(9,
                                        "delectus",
                                        "quis",
                                        "in"),
                                    true,
                                    true),
                                [9,
                                    4],
                            SpatialRelationship.EnvelopeIntersects,
                            new TimeExtent(new DateTime(2009, 5, 3, 21, 56, 32),
                                    new DateTime(2006, 5, 23, 5, 25, 0)),
                                QueryUnits.Meters,
                                "ObjectID = 1"),
                            [new Effect("dolor",
                                10346918.5870),
                                new Effect("deserunt",
                                    10815337.5273)])),
                    true,
                    true,
                    true,
                    "molestiae et nobis");
        await listItemPanelWidget.SetListItem(testListItem);
        var listItem = await listItemPanelWidget.GetListItem();
        Assert.AreEqual(testListItem, listItem);
    }
}
