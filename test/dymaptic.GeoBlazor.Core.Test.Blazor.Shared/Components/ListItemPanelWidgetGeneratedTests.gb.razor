@inherits TestRunnerBase

@{
    base.BuildRenderTree(__builder);
}

@code {

    [TestMethod]
    public async Task TestCanRenderGeneratedListItemPanelWidget(Action renderHandler)
    {
        ListItemPanelWidget? listItemPanelWidget = null;

        AddMapRenderFragment(
            @<MapView class="map-view" OnViewRendered="renderHandler">
                <Map>
                    <Basemap>
                        <BasemapStyle Name="BasemapStyleName.ArcgisTopographic" />
                    </Basemap>
                </Map>
                <ListItemPanelWidget 
                    Content="@([new ListItemPanelContent()])"
                    Disabled="@(true)"
                    FlowEnabled="@(true)"
                    Icon="@("unde")"
                    Image="@("https://picsum.photos/640/480/?image=551")"
                    Label="@("ipsum")"
                    Open="@(true)"
                    Title="@("non aut labore")"
                    WidgetId="@("mollitia")">
                    <ListItem 
                        ActionsOpen="@(true)"
                        ActionsSections="@(new ActionButton("alias porro quo",
                            "https://picsum.photos/640/480/?image=601",
                            "8e15b436-c620-f876-4b6c-60f0d1357a6c",
                            () => { Console.WriteLine("amet"); return Task.CompletedTask; },
                            "id",
                            true,
                            true,
                            true,
                            "facere"))"
                        ChildrenSortable="@(true)"
                        Hidden="@(true)"
                        Layer="@(new VectorTileLayer("possimus",
                            BlendMode.Normal,
                                default,
                                new Effect("blanditiis",
                                    8701860.4302),
                            new Extent(-45.8682,
                                    -120.0932,
                                    -75.7177,
                                    -10.3737,
                                    563.6723,
                                    663.7712,
                                    555.6679,
                                    438.8415,
                                new SpatialReference(6,
                                        "voluptatum",
                                        "ratione",
                                        "facilis"),
                                    true,
                                    true),
                            new Extent(-58.7509,
                                    -118.0024,
                                    -63.3879,
                                    84.1121,
                                    548.0909,
                                    612.8224,
                                    576.7642,
                                    673.9988,
                                new SpatialReference(3,
                                        "molestiae",
                                        "ex",
                                        "qui"),
                                    true,
                                    true),
                            ListMode.Hide,
                                16001299.7989,
                                3680.4556,
                                0.6075,
                                true,
                            new PortalItem(),
                            new SpatialReference(1,
                                    "voluptas",
                                    "est",
                                    "error"),
                                "voluptas"))"
                        ListModeDisabled="@(true)"
                        Open="@(true)"
                        Sortable="@(true)"
                        Title="@("ratione minus optio")">
                    </ListItem>
                </ListItemPanelWidget>
            </MapView>);
        await WaitForMapToRender();
        Assert.IsNotNull(listItemPanelWidget!);
        await AssertJavaScript("assertWidgetExists", args: "list-item-panel");
        ListItem testListItem = new ListItem(true,
                    new ActionButton("explicabo et reiciendis",
                        "https://picsum.photos/640/480/?image=871",
                        "4749892a-9510-e700-b74c-2dd496b56768",
                        () => { Console.WriteLine("delectus"); return Task.CompletedTask; },
                        "password",
                        true,
                        true,
                        true,
                        "debitis"),
                    true,
                    true,
                new FeatureLayer("https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/weather_stations_010417/FeatureServer/0",
                    new PortalItem(),
                    [new Graphic(new Polygon([new MapPath([new MapPoint([518.5497]),
                                new MapPoint([270.0499])]),
                                new MapPath([new MapPoint([86.7281])])],
                            new SpatialReference(1,
                                    "aut",
                                    "itaque",
                                    "voluptatem"),
                            new Point(4.9565,
                                    33.5843,
                                    175.9575,
                                    -51.1155,
                                    992.5521,
                                new SpatialReference(2,
                                        "est",
                                        "aut",
                                        "laboriosam"),
                                    true,
                                    true,
                                    92.9510),
                                true,
                                true,
                                true),
                        new TextSymbol("quos dignissimos aut",
                            new MapColor(47, 182, 252),
                            new MapColor(153, 106, 195),
                                new Dimension(433.9654),
                            new MapFont(new Dimension(561.5890),
                                    "Courier New",
                                MapFontStyle.Normal,
                                FontWeight.Lighter,
                                TextDecoration.LineThrough),
                                280.4655,
                            new MapColor(198, 66, 239),
                            new MapColor(111, 40, 43),
                                976.2087,
                            HorizontalAlignment.Center,
                                true,
                                267.9660,
                                new Dimension(955.6824),
                                true),
                        new PopupTemplate("ut dignissimos natus",
                                "qui",
                                ["veniam",
                                    "maxime"],
                            [new FieldInfo("phone",
                                    "culpa",
                                    "repudiandae",
                                StringFieldOption.TextBox,
                                new FieldInfoFormat(3,
                                        true,
                                    DateFormat.LongDateLongTime),
                                    true,
                                    true,
                                StatisticType.Sum)],
                            [new MediaPopupContent("et aut fugit",
                                    "fuga velit assumenda",
                                [new ImageMediaInfo("magni quia sint",
                                        "sed",
                                        "pariatur numquam minus",
                                    new ImageMediaInfoValue("http://alexandrine.com",
                                            "http://melyna.info"),
                                        571.5760),
                                new PieChartMediaInfo("vel odio blanditiis",
                                        "quisquam",
                                        "explicabo illo magnam",
                                    new ChartMediaInfoValue(["provident",
                                            "odit"],
                                            "tempora",
                                            "ad",
                                        [new ChartMediaInfoValueSeries("title",
                                                "perspiciatis",
                                                317.3593),
                                        new ChartMediaInfoValueSeries("updatedAt",
                                                "soluta",
                                                201.2987)],
                                        [new MapColor(187, 201, 72)]))],
                                    3)],
                            [new ExpressionInfo("var area = Geometry($feature).area; return area;",
                                    "category",
                                    "expedita quia libero",
                                    ExpressionInfoReturnType.String)],
                                true,
                                true,
                                [new ActionButton("et ab quia",
                                    "https://picsum.photos/640/480/?image=533",
                                    "e7572cde-6969-8247-d05c-cb5830a1b5aa",
                                    () => { Console.WriteLine("eos"); return Task.CompletedTask; },
                                    "title",
                                    true,
                                    true,
                                    true,
                                    "totam"),
                                    new ActionButton("aspernatur eum necessitatibus",
                                        "https://picsum.photos/640/480/?image=258",
                                        "d6d65e7e-32dd-529d-60d8-af5e7b5f1b24",
                                        () => { Console.WriteLine("dolore"); return Task.CompletedTask; },
                                        "password",
                                        true,
                                        true,
                                        true,
                                        "impedit")]),
                            new AttributesDictionary(),
                            true,
                            "minus",
                            "inventore",
                            new GraphicOrigin(Guid.NewGuid(),
                                "accusamus",
                                5))],
                        ["temporibus"],
                        "nemo",
                        6693.4315,
                        10571191.5334,
                        "aut",
                        FeatureGeometryType.Point,
                        "consequatur ex praesentium",
                        0.1964,
                        true,
                    ListMode.Show,
                    new PopupTemplate("non quia non",
                            "debitis",
                            ["dolor"],
                        [new FieldInfo("title",
                                "ducimus",
                                "accusantium",
                            StringFieldOption.TextArea,
                            new FieldInfoFormat(4,
                                    true,
                                DateFormat.DayShortMonthYearShortTime24),
                                true,
                                true,
                            StatisticType.Min),
                        new FieldInfo("token",
                                "aliquid",
                                "odit",
                            StringFieldOption.RichText,
                            new FieldInfoFormat(9,
                                    true,
                                DateFormat.LongMonthYear),
                                true,
                                true,
                            StatisticType.Count)],
                        [new MediaPopupContent("quasi suscipit sit",
                                "magni nobis maxime",
                            [new ImageMediaInfo("perspiciatis veritatis sunt",
                                    "voluptatibus",
                                    "alias et vero",
                                new ImageMediaInfoValue("http://taya.org",
                                        "http://rebeka.name"),
                                    400.0701)],
                                4)],
                        [new ExpressionInfo("return $feature['FieldName'];",
                                "id",
                                "optio nihil quia",
                                ExpressionInfoReturnType.String),
                        new ExpressionInfo("return $feature.Status == 'Active' ? 'Active' : 'Inactive';",
                                "avatar",
                                "qui magni iusto",
                                ExpressionInfoReturnType.String)],
                            true,
                            true,
                            [new ActionButton("quas nemo cumque",
                                "https://picsum.photos/640/480/?image=40",
                                "b5ba8aff-7f97-13be-c5b5-df40d76d593f",
                                () => { Console.WriteLine("architecto"); return Task.CompletedTask; },
                                "token",
                                true,
                                true,
                                true,
                                "iure")])),
                    true,
                    true,
                    true,
                    "at sequi nihil");
        await listItemPanelWidget.SetListItem(testListItem);
        var listItem = await listItemPanelWidget.GetListItem();
        Assert.AreEqual(testListItem, listItem);
    }
}
