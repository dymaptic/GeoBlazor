@inherits TestRunnerBase

@{
    base.BuildRenderTree(__builder);
}

@code {

    [TestMethod]
    public async Task TestCanRenderGeneratedBookmarksWidget(Action renderHandler)
    {
        BookmarksWidget? bookmarksWidget = null;

        BookmarksBookmarkEditEvent? bookmarkEditResult = null;
        void OnBookmarkEdit(BookmarksBookmarkEditEvent result)
        {
            bookmarkEditResult = result;
        }
        BookmarkSelectEvent? bookmarkSelectResult = null;
        void OnBookmarkSelect(BookmarkSelectEvent result)
        {
            bookmarkSelectResult = result;
        }
        AddMapRenderFragment(
            @<MapView class="map-view" OnViewRendered="renderHandler">
                <Map>
                    <Basemap>
                        <BasemapStyle Name="BasemapStyleName.ArcgisTopographic" />
                    </Basemap>
                </Map>
                <BookmarksWidget 
                    Bookmarks="@([new Bookmark("title",
                        new TimeExtent(new DateTime(2016, 1, 16, 13, 35, 24),
                                new DateTime(2018, 10, 21, 8, 23, 45)),
                        new BookmarkThumbnail("https://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Countries_(Generalized)/FeatureServer/0"),
                        new Viewpoint(new Polyline([new MapPath([new MapPoint([520.4433,
                                        779.3217])])],
                                new SpatialReference(4,
                                        "omnis",
                                        "nobis",
                                        "rerum"),
                                    true,
                                    true),
                                38692568.2411,
                                83.7966,
                            new Camera(519.3207,
                                    573.7503,
                                new CameraLayout(515.3769,
                                        789.2571,
                                        340.8478,
                                        952.9026),
                                new Point(-117.4465,
                                        41.7081,
                                        -55.0545,
                                        56.7982,
                                        264.1232,
                                    new SpatialReference(9,
                                            "sed",
                                            "ducimus",
                                            "voluptatem"),
                                        true,
                                        true,
                                        76.8600),
                                    81.5577)))])"
                    DefaultCreateOptions="@(new BookmarkOptions(true,
                            true,
                            true,
                            true,
                        new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(5,
                                    8,
                                    77.1608,
                                    -13.0222),
                                6,
                            [new BaseTileLayer(BlendMode.Plus,
                                    new Effect("exercitationem",
                                        12413954.4052),
                                    27301709.9735,
                                    1886.0917,
                                    921.5546,
                                new SpatialReference(7,
                                        "quidem",
                                        "vel",
                                        "reprehenderit"),
                                new Extent(37.1581,
                                        156.6078,
                                        55.7145,
                                        86.4520,
                                        186.4259,
                                        585.6225,
                                        761.0771,
                                        3.0842,
                                    new SpatialReference(2,
                                            "optio",
                                            "rem",
                                            "labore"),
                                        true,
                                        true),
                                ListMode.Hide,
                                    0.0786,
                                    true,
                                new TileInfo(161.6745,
                                        TileInfoFormat.Tiff,
                                        true,
                                    [new LOD(2,
                                            "sunt",
                                            50.7202,
                                            23750228.4843),
                                    new LOD(8,
                                            "nesciunt",
                                            11.7296,
                                            44273496.6424)],
                                    new Point(-25.5735,
                                            -20.2015,
                                            172.8787,
                                            -39.0042,
                                            888.3421,
                                        new SpatialReference(8,
                                                "corrupti",
                                                "quia",
                                                "explicabo"),
                                            true,
                                            true,
                                            789.3443),
                                        [8,
                                            8],
                                    new SpatialReference(6,
                                            "molestiae",
                                            "dolorem",
                                            "possimus")),
                                    "et voluptatem excepturi",
                                new TimeExtent(new DateTime(2016, 10, 18, 16, 51, 55),
                                        new DateTime(2014, 4, 3, 11, 4, 40)))],
                                6),
                            true))"
                    DefaultEditOptions="@(new BookmarkOptions(true,
                            true,
                            true,
                            true,
                        new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(9,
                                    7,
                                    8.2648,
                                    17.8831),
                                5,
                            [new ElevationLayer("qui",
                                new Extent(68.4834,
                                        113.3303,
                                        -16.8351,
                                        -36.6694,
                                        392.7761,
                                        6.2723,
                                        64.3306,
                                        587.9370,
                                    new SpatialReference(8,
                                            "libero",
                                            "accusantium",
                                            "omnis"),
                                        true,
                                        true),
                                ListMode.Show,
                                    0.8299,
                                    true,
                                new PortalItem(),
                                new TileInfo(131.2707,
                                        TileInfoFormat.Svgz,
                                        true,
                                    [new LOD(9,
                                            "omnis",
                                            8.0543,
                                            28091498.8572),
                                    new LOD(9,
                                            "at",
                                            94.7533,
                                            5388390.2253)],
                                    new Point(101.6912,
                                            61.1849,
                                            -133.1450,
                                            -4.5692,
                                            840.7910,
                                        new SpatialReference(6,
                                                "provident",
                                                "tenetur",
                                                "explicabo"),
                                            true,
                                            true,
                                            672.0883),
                                        [9],
                                    new SpatialReference(2,
                                            "natus",
                                            "qui",
                                            "repellat")),
                                    "voluptatem qui dolore",
                                    "https://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Countries_(Generalized)/FeatureServer/0",
                                new TimeExtent(new DateTime(2019, 6, 9, 4, 25, 0),
                                        new DateTime(2007, 6, 21, 21, 31, 13)))],
                                4),
                            true))"
                    Disabled="@(true)"
                    DragEnabled="@(true)"
                    FilterPlaceholder="@("et")"
                    FilterText="@("optio omnis tenetur")"
                    HeadingLevel="@(6)"
                    Icon="@("cupiditate")"
                    Label="@("odit")"
                    WidgetId="@("qui")"
                    OnBookmarkEdit="OnBookmarkEdit"
                    OnBookmarkSelect="OnBookmarkSelect">
                    <BookmarksVisibleElements 
                        AddBookmarkButton="@(true)"
                        CloseButton="@(true)"
                        CollapseButton="@(true)"
                        EditBookmarkButton="@(true)"
                        Filter="@(true)"
                        Flow="@(true)"
                        Heading="@(true)"
                        Thumbnail="@(true)"
                        Time="@(true)">
                    </BookmarksVisibleElements>
                    <BookmarksViewModel 
                        Bookmarks="@([new Bookmark("password",
                            new TimeExtent(new DateTime(2006, 9, 12, 15, 49, 29),
                                    new DateTime(2016, 7, 15, 15, 58, 38)),
                            new BookmarkThumbnail("https://services3.arcgis.com/GVgbJbqm8hXASVYi/arcgis/rest/services/Parks_and_Open_Space/FeatureServer/0"),
                            new Viewpoint(new Extent(-52.5177,
                                        112.3704,
                                        -74.4096,
                                        -82.7588,
                                        463.8323,
                                        352.5852,
                                        728.0319,
                                        891.2677,
                                    new SpatialReference(3,
                                            "qui",
                                            "beatae",
                                            "eligendi"),
                                        true,
                                        true),
                                    13092506.4140,
                                    148.3194,
                                new Camera(194.8690,
                                        795.7079,
                                    new CameraLayout(899.0413,
                                            207.8722,
                                            447.8137,
                                            701.9506),
                                    new Point(23.6510,
                                            82.2382,
                                            -6.0112,
                                            -87.2925,
                                            984.6343,
                                        new SpatialReference(6,
                                                "provident",
                                                "eveniet",
                                                "sequi"),
                                            true,
                                            true,
                                            74.4785),
                                        686.1325))),
                        new Bookmark("password",
                            new TimeExtent(new DateTime(2015, 1, 18, 12, 4, 39),
                                    new DateTime(2023, 2, 18, 14, 34, 58)),
                            new BookmarkThumbnail("https://services9.arcgis.com/RHVPKKiFTONKtxq3/arcgis/rest/services/NDFD_Precipitation_v1/FeatureServer/0"),
                            new Viewpoint(new Polyline([new MapPath([new MapPoint([987.7180,
                                            247.3557]),
                                        new MapPoint([568.0875,
                                            286.0322])]),
                                        new MapPath([new MapPoint([167.2520])])],
                                    new SpatialReference(7,
                                            "delectus",
                                            "reprehenderit",
                                            "dolorem"),
                                        true,
                                        true),
                                    11172960.2571,
                                    70.4281,
                                new Camera(646.0588,
                                        360.9530,
                                    new CameraLayout(250.0285,
                                            662.5846,
                                            140.9204,
                                            666.0078),
                                    new Point(53.7330,
                                            -51.1795,
                                            148.7066,
                                            31.7849,
                                            590.9214,
                                        new SpatialReference(6,
                                                "sint",
                                                "fugit",
                                                "nihil"),
                                            true,
                                            true,
                                            151.5270),
                                        984.0017)))])"
                        Capabilities="@(new BookmarksCapabilities(true))"
                        DefaultCreateOptions="@(new BookmarkOptions(true,
                                true,
                                true,
                                true,
                            new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(2,
                                        1,
                                        -90.9197,
                                        -65.9858),
                                    2,
                                [new GeoJSONLayer("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.geojson",
                                        "iusto",
                                        "doloremque accusantium facilis",
                                        0.2457,
                                        true,
                                    ListMode.Show,
                                    BlendMode.Invert,
                                        default,
                                        "a",
                                        "incidunt",
                                        true,
                                        new Effect("ex",
                                            13912388.6832),
                                    new GeoJSONLayerElevationInfo(new GeoJSONLayerElevationInfoFeatureExpressionInfo("var length = Geometry($feature).length; return length;",
                                                "vel totam qui"),
                                        ElevationInfoMode.RelativeToGround,
                                            175.9272,
                                        ElevationUnit.UsFeet),
                                    new FeatureEffect([new Effect("ut",
                                            49919125.0470)],
                                            true,
                                        new FeatureFilter(666.6627,
                                            new Polygon([new MapPath([new MapPoint([463.0938]),
                                                    new MapPoint([41.6007,
                                                        836.5114])])],
                                                new SpatialReference(1,
                                                        "dicta",
                                                        "consequuntur",
                                                        "excepturi"),
                                                new Point(-98.5304,
                                                        -58.5172,
                                                        -123.7887,
                                                        23.8594,
                                                        832.1270,
                                                    new SpatialReference(),
                                                        true,
                                                        true,
                                                        943.9858),
                                                    true,
                                                    true,
                                                    true),
                                                [8],
                                            SpatialRelationship.Overlaps,
                                            new TimeExtent(new DateTime(2002, 2, 6, 8, 26, 21),
                                                    new DateTime(2013, 11, 16, 3, 39, 53)),
                                                QueryUnits.Feet,
                                                "PostalCode = 'M5V 1J9'"),
                                            [new Effect("omnis",
                                                45126918.2206)]))],
                                    3),
                                true))"
                        DefaultEditOptions="@(new BookmarkOptions(true,
                                true,
                                true,
                                true,
                            new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(1,
                                        7,
                                        141.1402,
                                        31.8651),
                                    4,
                                [new BingMapsLayer("beatae",
                                        BingImageryStyle.Road,
                                    BlendMode.Plus,
                                        new Effect("sit",
                                            21013400.1006),
                                        27759596.4309,
                                        33083.0804,
                                        224.7920,
                                    new SpatialReference(5,
                                            "delectus",
                                            "ullam",
                                            "omnis"),
                                        default,
                                    new Extent(-158.9055,
                                            102.0268,
                                            8.0351,
                                            76.2210,
                                            951.5388,
                                            258.3521,
                                            21.3087,
                                            733.2958,
                                        new SpatialReference(1,
                                                "dicta",
                                                "sapiente",
                                                "et"),
                                            true,
                                            true),
                                    ListMode.Show,
                                        0.7438,
                                        true,
                                        "sed")],
                                    9),
                                true))">
                    </BookmarksViewModel>
                </BookmarksWidget>
            </MapView>);
        await WaitForMapToRender();
        Assert.IsNotNull(bookmarksWidget!);
        await AssertJavaScript("dispatchEvent", args: [bookmarksWidget!.Id, "bookmark-edit"]);
        await AssertJavaScript("dispatchEvent", args: [bookmarksWidget!.Id, "bookmark-select"]);
        int tries = 100;
        while (tries > 0 &&
            (bookmarkEditResult is null || 
            bookmarkSelectResult is null))
        {
            await Task.Delay(100);
            tries--;
        }
        Assert.IsInstanceOfType<BookmarksBookmarkEditEvent>(bookmarkEditResult);
        Assert.IsInstanceOfType<BookmarkSelectEvent>(bookmarkSelectResult);
        await AssertJavaScript("assertWidgetExists", args: "bookmarks");
        var goToMethodResult = await bookmarksWidget.GoTo(new Bookmark("updatedAt",
                new TimeExtent(new DateTime(2023, 2, 20, 17, 31, 11),
                        new DateTime(2004, 4, 24, 22, 39, 49)),
                new BookmarkThumbnail("https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/weather_stations_010417/FeatureServer/0"),
                new Viewpoint(new Extent(-25.4318,
                            -77.6211,
                            12.2910,
                            -34.0286,
                            985.8070,
                            617.1232,
                            887.1809,
                            259.1210,
                        new SpatialReference(5,
                                "voluptas",
                                "qui",
                                "fugiat"),
                            true,
                            true),
                        23947001.4785,
                        278.8087,
                    new Camera(805.0577,
                            333.4597,
                        new CameraLayout(77.1154,
                                942.6985,
                                563.0737,
                                681.7587),
                        new Point(35.8822,
                                53.2661,
                                -130.4404,
                                -86.4043,
                                986.2237,
                            new SpatialReference(3,
                                    "et",
                                    "earum",
                                    "aperiam"),
                                true,
                                true,
                                560.8154),
                            394.7681))));
        Assert.IsNotNull(goToMethodResult);
        IReadOnlyList<Bookmark> testBookmarks = [new Bookmark("password",
                new TimeExtent(new DateTime(2008, 11, 12, 14, 27, 9),
                        new DateTime(2011, 6, 22, 9, 14, 55)),
                new BookmarkThumbnail("https://services3.arcgis.com/GVgbJbqm8hXASVYi/arcgis/rest/services/Parks_and_Open_Space/FeatureServer/0"),
                new Viewpoint(new Point(-58.7685,
                            -71.0564,
                            176.9246,
                            -29.7626,
                            818.4526,
                        new SpatialReference(4,
                                "nihil",
                                "dicta",
                                "consequatur"),
                            true,
                            true,
                            547.1487),
                        5308995.6080,
                        148.4692,
                    new Camera(162.5555,
                            180.5813,
                        new CameraLayout(938.7790,
                                171.9221,
                                458.2535,
                                210.2821),
                        new Point(-57.9905,
                                27.2076,
                                87.0756,
                                -61.4159,
                                716.7439,
                            new SpatialReference(5,
                                    "itaque",
                                    "ipsam",
                                    "et"),
                                true,
                                true,
                                240.4221),
                            528.3215)))];
        await bookmarksWidget.SetBookmarks(testBookmarks);
        var bookmarks = await bookmarksWidget.GetBookmarks();
        Assert.AreEqual(testBookmarks, bookmarks);
        BookmarkOptions testDefaultCreateOptions = new BookmarkOptions(true,
                    true,
                    true,
                    true,
                new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(4,
                            6,
                            20.5707,
                            36.5177),
                        1,
                    [new MapImageLayer("https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer",
                        new PortalItem(),
                        BlendMode.Color,
                            default,
                            467.4830,
                            new Effect("accusantium",
                                35563669.9911),
                            "6.1.8.1",
                            MapImageFormat.Gif,
                            1,
                            3,
                            true,
                            true,
                            32453600.9451,
                            27990.0425,
                        null,
                        null,
                        null,
                        null,
                        null,
                        null,
                        null,
                            true),
                    new CSVLayer("https://developers.arcgis.com/javascript/latest//sample-code/layers-csv/live/earthquakes.csv",
                            "et reprehenderit illum",
                            "natus",
                            0.3997,
                            true,
                        ListMode.Hide,
                        BlendMode.Saturation,
                        new PopupTemplate("libero rem ipsam",
                                "ab",
                                ["iste"],
                            [new FieldInfo("category",
                                    "repudiandae",
                                    "exercitationem",
                                StringFieldOption.TextArea,
                                new FieldInfoFormat(6,
                                        true,
                                    DateFormat.LongMonthDayYearShortTime),
                                    true,
                                    true,
                                StatisticType.Var)],
                            [new AttachmentsPopupContent("officiis iure cupiditate",
                                    "sit beatae maxime",
                                    AttachmentsPopupContentDisplayType.Auto)],
                            [new ExpressionInfo("var length = Geometry($feature).length; return length;",
                                    "email",
                                    "nostrum fugiat tempore",
                                    ExpressionInfoReturnType.String),
                            new ExpressionInfo("var length = Geometry($feature).length; return length;",
                                    "phone",
                                    "nisi non ratione",
                                    ExpressionInfoReturnType.String)],
                                true,
                                true,
                                [new ActionButton("ut ratione omnis",
                                    "https://picsum.photos/640/480/?image=388",
                                    "f9102a3e-646a-47d4-3e4b-1f47dac1379e",
                                    () => { Console.WriteLine("nemo"); return Task.CompletedTask; },
                                    "email",
                                    true,
                                    true,
                                    true,
                                    "occaecati")]),
                            default,
                            "vitae",
                            CSVDelimiter.Semicolon,
                            "labore",
                            new Effect("cum",
                                19540481.2010),
                        new CSVLayerElevationInfo(new CSVLayerElevationInfoFeatureExpressionInfo("return $feature['FieldName'];",
                                    "velit eligendi quia"),
                            ElevationInfoMode.OnTheGround,
                                444.7909,
                            ElevationUnit.Feet))],
                        4),
                    true);
        await bookmarksWidget.SetDefaultCreateOptions(testDefaultCreateOptions);
        var defaultCreateOptions = await bookmarksWidget.GetDefaultCreateOptions();
        Assert.AreEqual(testDefaultCreateOptions, defaultCreateOptions);
        BookmarkOptions testDefaultEditOptions = new BookmarkOptions(true,
                    true,
                    true,
                    true,
                new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(6,
                            9,
                            130.1221,
                            -58.3304),
                        2,
                    [new MapImageLayer("https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer",
                        new PortalItem(),
                        BlendMode.SourceOut,
                            default,
                            597.2544,
                            new Effect("omnis",
                                13357645.8280),
                            "2.6.5.2",
                            MapImageFormat.Gif,
                            9,
                            6,
                            true,
                            true,
                            46986368.7537,
                            35345.1883,
                        null,
                        null,
                        null,
                        null,
                        null,
                        null,
                        null,
                            true)],
                        7),
                    true);
        await bookmarksWidget.SetDefaultEditOptions(testDefaultEditOptions);
        var defaultEditOptions = await bookmarksWidget.GetDefaultEditOptions();
        Assert.AreEqual(testDefaultEditOptions, defaultEditOptions);
        BookmarksViewModel testViewModel = new BookmarksViewModel([new Bookmark("token",
                    new TimeExtent(new DateTime(2009, 5, 9, 22, 39, 49),
                            new DateTime(2006, 6, 18, 8, 34, 31)),
                    new BookmarkThumbnail("https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/IncidentsReport/FeatureServer/0"),
                    new Viewpoint(new Point(92.8509,
                                77.6258,
                                -66.9340,
                                8.7467,
                                92.0376,
                            new SpatialReference(9,
                                    "illum",
                                    "molestiae",
                                    "voluptatibus"),
                                true,
                                true,
                                334.3925),
                            18526976.0115,
                            191.6048,
                        new Camera(699.2106,
                                656.1977,
                            new CameraLayout(610.0672,
                                    547.8842,
                                    130.7623,
                                    750.0769),
                            new Point(-35.9209,
                                    15.6204,
                                    -17.9189,
                                    -53.9959,
                                    333.3015,
                                new SpatialReference(7,
                                        "recusandae",
                                        "consequatur",
                                        "vero"),
                                    true,
                                    true,
                                    718.3992),
                                522.1450)))],
                new BookmarksCapabilities(true),
                new BookmarkOptions(true,
                        true,
                        true,
                        true,
                    new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(2,
                                6,
                                145.5801,
                                64.0024),
                            9,
                        [new WebTileLayer(BlendMode.Overlay,
                                "et",
                                new Effect("earum",
                                    44756958.1513),
                            new Extent(-3.2797,
                                    118.3758,
                                    45.2134,
                                    86.3085,
                                    33.6110,
                                    90.7279,
                                    889.3361,
                                    90.0016,
                                new SpatialReference(1,
                                        "cupiditate",
                                        "qui",
                                        "sequi"),
                                    true,
                                    true),
                            ListMode.Hide,
                                7585998.2239,
                                3118.4312,
                                0.4585,
                                true,
                            new PortalItem(),
                                493.6623,
                                ["non",
                                    "at"],
                            new TileInfo(357.8997,
                                    TileInfoFormat.Pdf,
                                    true,
                                [new LOD(9,
                                        "voluptas",
                                        99.0840,
                                        44066764.3815)],
                                new Point(-20.3697,
                                        64.1318,
                                        148.5983,
                                        32.5630,
                                        765.2637,
                                    new SpatialReference(7,
                                            "ipsum",
                                            "dolorem",
                                            "quam"),
                                        true,
                                        true,
                                        385.3390),
                                    [1,
                                        7],
                                new SpatialReference(2,
                                        "molestiae",
                                        "earum",
                                        "tempore")),
                                "vel rerum consequatur"),
                        new ElevationLayer("eos",
                            new Extent(0.3562,
                                    36.3720,
                                    -4.7414,
                                    20.0568,
                                    344.0444,
                                    210.2831,
                                    773.3493,
                                    794.2436,
                                new SpatialReference(9,
                                        "esse",
                                        "et",
                                        "rerum"),
                                    true,
                                    true),
                            ListMode.Hide,
                                0.3855,
                                true,
                            new PortalItem(),
                            new TileInfo(605.3812,
                                    TileInfoFormat.Mixed,
                                    true,
                                [new LOD(7,
                                        "aut",
                                        48.3782,
                                        44536325.0195)],
                                new Point(-131.0689,
                                        -70.5865,
                                        -177.8044,
                                        -37.9354,
                                        873.5970,
                                    new SpatialReference(1,
                                            "cum",
                                            "unde",
                                            "rerum"),
                                        true,
                                        true,
                                        134.8656),
                                    [6],
                                new SpatialReference(7,
                                        "dicta",
                                        "quam",
                                        "in")),
                                "nihil atque quos",
                                "https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/IncidentsReport/FeatureServer/0",
                            new TimeExtent(new DateTime(2006, 7, 10, 20, 55, 14),
                                    new DateTime(2007, 9, 16, 16, 32, 54)))],
                            6),
                        true),
                new BookmarkOptions(true,
                        true,
                        true,
                        true,
                    new BookmarkOptionsScreenshotSettings(new BookmarkOptionsScreenshotSettingsArea(8,
                                4,
                                -177.5336,
                                31.3179),
                            8,
                        [new GraphicsLayer([new Graphic(new Polyline([new MapPath([new MapPoint([567.1262,
                                            386.2468])])],
                                    new SpatialReference(2,
                                            "fugit",
                                            "quo",
                                            "velit"),
                                        true,
                                        true),
                                new TextSymbol("dicta expedita temporibus",
                                    new MapColor(35, 209, 26),
                                    new MapColor(55, 56, 83),
                                        new Dimension(866.4169),
                                    new MapFont(new Dimension(135.8193),
                                            "Arial",
                                        MapFontStyle.Oblique,
                                        FontWeight.Bolder,
                                        TextDecoration.Underline),
                                        492.4785,
                                    new MapColor(143, 29, 32),
                                    new MapColor(207, 110, 235),
                                        356.0221,
                                    HorizontalAlignment.Right,
                                        true,
                                        732.5888,
                                        new Dimension(610.6647),
                                        true),
                                new PopupTemplate("at magni voluptas",
                                        "molestiae",
                                        ["eveniet",
                                            "veniam"],
                                    [new FieldInfo("avatar",
                                            "et",
                                            "minima",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(5,
                                                true,
                                            DateFormat.ShortDateLeLongTime),
                                            true,
                                            true,
                                        StatisticType.Min)],
                                    [new ExpressionPopupContent(new ElementExpressionInfo("return $feature.City + ', ' + $feature.Country;",
                                                "architecto",
                                                "et unde ut"))],
                                    [new ExpressionInfo("var x = $feature.X; var y = $feature.Y; return x + ', ' + y;",
                                            "updatedAt",
                                            "quod ut non",
                                            ExpressionInfoReturnType.String),
                                    new ExpressionInfo("return Date();",
                                            "title",
                                            "cupiditate deleniti quia",
                                            ExpressionInfoReturnType.String)],
                                        true,
                                        true,
                                        [new ActionButton("enim est molestias",
                                            "https://picsum.photos/640/480/?image=844",
                                            "d3103388-4a5c-dae0-0329-fbfb966e880f",
                                            () => { Console.WriteLine("voluptate"); return Task.CompletedTask; },
                                            "comment",
                                            true,
                                            true,
                                            true,
                                            "eveniet"),
                                            new ActionButton("sed veniam sequi",
                                                "https://picsum.photos/640/480/?image=313",
                                                "82c20ef6-1fa4-7e67-20db-76622e7270fa",
                                                () => { Console.WriteLine("saepe"); return Task.CompletedTask; },
                                                "phone",
                                                true,
                                                true,
                                                true,
                                                "inventore")]),
                                    new AttributesDictionary(),
                                    true,
                                    "nisi",
                                    "at",
                                    new GraphicOrigin(Guid.NewGuid(),
                                        "aliquid",
                                        5)),
                            new Graphic(new Polyline([new MapPath([new MapPoint([66.0187]),
                                        new MapPoint([292.1404])])],
                                    new SpatialReference(6,
                                            "quaerat",
                                            "inventore",
                                            "ut"),
                                        true,
                                        true),
                                new TextSymbol("unde in quae",
                                    new MapColor(39, 13, 114),
                                    new MapColor(82, 243, 104),
                                        new Dimension(711.9883),
                                    new MapFont(new Dimension(919.3114),
                                            "Times New Roman",
                                        MapFontStyle.Normal,
                                        FontWeight.Normal,
                                        TextDecoration.Underline),
                                        490.6951,
                                    new MapColor(172, 183, 57),
                                    new MapColor(242, 116, 101),
                                        455.0289,
                                    HorizontalAlignment.Right,
                                        true,
                                        475.6019,
                                        new Dimension(462.0733),
                                        true),
                                new PopupTemplate("asperiores ad labore",
                                        "rerum",
                                        ["deserunt"],
                                    [new FieldInfo("name",
                                            "voluptatum",
                                            "veritatis",
                                        StringFieldOption.TextArea,
                                        new FieldInfoFormat(1,
                                                true,
                                            DateFormat.ShortDateLeLongTime24),
                                            true,
                                            true,
                                        StatisticType.Max)],
                                    [new ExpressionPopupContent(new ElementExpressionInfo("var length = Geometry($feature).length; return length;",
                                                "illum",
                                                "fugiat doloribus ex")),
                                    new ExpressionPopupContent(new ElementExpressionInfo("return $feature.City + ', ' + $feature.Country;",
                                                "aperiam",
                                                "quia impedit minima"))],
                                    [new ExpressionInfo("return Date();",
                                            "id",
                                            "vel vel ea",
                                            ExpressionInfoReturnType.String),
                                    new ExpressionInfo("return $feature['FieldName'];",
                                            "password",
                                            "ratione et repellat",
                                            ExpressionInfoReturnType.String)],
                                        true,
                                        true,
                                        [new ActionButton("sed aut voluptatem",
                                            "https://picsum.photos/640/480/?image=882",
                                            "861ac8cf-6b9e-85b2-614a-905142507c21",
                                            () => { Console.WriteLine("qui"); return Task.CompletedTask; },
                                            "category",
                                            true,
                                            true,
                                            true,
                                            "enim"),
                                            new ActionButton("beatae modi sunt",
                                                "https://picsum.photos/640/480/?image=720",
                                                "7a118cdc-d0a1-9759-0369-db23568e833e",
                                                () => { Console.WriteLine("enim"); return Task.CompletedTask; },
                                                "token",
                                                true,
                                                true,
                                                true,
                                                "excepturi")]),
                                    new AttributesDictionary(),
                                    true,
                                    "tenetur",
                                    "sapiente",
                                    new GraphicOrigin(Guid.NewGuid(),
                                        "nostrum",
                                        6))],
                                "dolorum debitis ullam",
                                0.2923,
                                true,
                            ListMode.Hide,
                                true,
                                11105.1018,
                                16356517.6764,
                                true,
                            BlendMode.VividLight,
                                new Effect("quia",
                                    13798662.9525),
                            new GraphicsLayerElevationInfo(new GraphicsLayerElevationInfoFeatureExpressionInfo("return $feature.Population / $feature.Area;",
                                        "ea qui quaerat"),
                                ElevationInfoMode.AbsoluteHeight,
                                    519.6410,
                                ElevationUnit.Inches),
                            new Extent(-51.9179,
                                    -58.4468,
                                    81.8970,
                                    73.7398,
                                    695.2249,
                                    674.0083,
                                    785.1590,
                                    863.5281,
                                new SpatialReference(7,
                                        "suscipit",
                                        "animi",
                                        "voluptatum"),
                                    true,
                                    true),
                            new TimeExtent(new DateTime(2016, 5, 22, 1, 17, 44),
                                    new DateTime(2000, 11, 22, 11, 56, 40))),
                        new CSVLayer("https://developers.arcgis.com/javascript/latest//sample-code/layers-csv/live/earthquakes.csv",
                                "repudiandae quo commodi",
                                "dolor",
                                0.4451,
                                true,
                            ListMode.Hide,
                            BlendMode.ColorDodge,
                            new PopupTemplate("nesciunt vel praesentium",
                                    "id",
                                    ["delectus"],
                                [new FieldInfo("password",
                                        "numquam",
                                        "debitis",
                                    StringFieldOption.RichText,
                                    new FieldInfoFormat(4,
                                            true,
                                        DateFormat.ShortDateLeLongTime),
                                        true,
                                        true,
                                    StatisticType.Var),
                                new FieldInfo("name",
                                        "inventore",
                                        "fuga",
                                    StringFieldOption.RichText,
                                    new FieldInfoFormat(9,
                                            true,
                                        DateFormat.DayShortMonthYearShortTime24),
                                        true,
                                        true,
                                    StatisticType.Count)],
                                [new TextPopupContent("fugit impedit recusandae"),
                                new RelationshipPopupContent("at aut deleniti",
                                        "commodi corrupti ratione rerum",
                                        8,
                                        "architecto",
                                    [new RelatedRecordsInfoFieldOrder("cumque",
                                        OrderBy.Asc)],
                                        4)],
                                [new ExpressionInfo("return $feature['FieldName'];",
                                        "avatar",
                                        "quaerat magni ut",
                                        ExpressionInfoReturnType.String),
                                new ExpressionInfo("return $feature.Name;",
                                        "title",
                                        "vel maiores animi",
                                        ExpressionInfoReturnType.String)],
                                    true,
                                    true,
                                    [new ActionButton("cum placeat impedit",
                                        "https://picsum.photos/640/480/?image=1022",
                                        "4a3c6d09-33ee-be7e-c886-7373ebed77af",
                                        () => { Console.WriteLine("quo"); return Task.CompletedTask; },
                                        "title",
                                        true,
                                        true,
                                        true,
                                        "est"),
                                        new ActionButton("pariatur qui hic",
                                            "https://picsum.photos/640/480/?image=849",
                                            "d6b59d0a-d966-a285-7720-b7846bd2508e",
                                            () => { Console.WriteLine("repudiandae"); return Task.CompletedTask; },
                                            "category",
                                            true,
                                            true,
                                            true,
                                            "voluptate")]),
                                default,
                                "incidunt",
                                CSVDelimiter.Pipe,
                                "non",
                                new Effect("aut",
                                    11549272.4694),
                            new CSVLayerElevationInfo(new CSVLayerElevationInfoFeatureExpressionInfo("var length = Geometry($feature).length; return length;",
                                        "tempora corporis ut"),
                                ElevationInfoMode.RelativeToScene,
                                    92.8593,
                                ElevationUnit.NauticalMiles))],
                            4),
                        true),
                null);
        await bookmarksWidget.SetViewModel(testViewModel);
        var viewModel = await bookmarksWidget.GetViewModel();
        Assert.AreEqual(testViewModel, viewModel);
        BookmarksVisibleElements testVisibleElements = new BookmarksVisibleElements(true,
                    true,
                    true,
                    true,
                    true,
                    true,
                    true,
                    true,
                    true);
        await bookmarksWidget.SetVisibleElements(testVisibleElements);
        var visibleElements = await bookmarksWidget.GetVisibleElements();
        Assert.AreEqual(testVisibleElements, visibleElements);
    }
}
